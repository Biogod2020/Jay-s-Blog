<!DOCTYPE html>
<html lang="zh-CN" class="scroll-smooth">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TeamPath: 多模态病理专家与推理副驾驶系统 | 架构深度解析</title>
    <meta name="description" content="TeamPath 论文深度解析：融合 Patho-R1 推理能力与 Cell2Sentence 生成范式的系统级 AI 架构">

    <!-- 1. Tailwind CSS (CDN) -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'system-ui', 'sans-serif'],
                        serif: ['Merriweather', 'Georgia', 'serif'],
                        mono: ['JetBrains Mono', 'Fira Code', 'monospace'],
                    },
                    colors: {
                        slate: { 850: '#151e2e' },
                        teampath: {
                            primary: '#059669', /* Emerald 600 */
                            light: '#d1fae5',
                            dark: '#064e3b',
                        },
                        router: {
                            base: '#f59e0b', /* Amber 500 */
                            bg: '#fffbeb',
                        },
                        reasoning: {
                            base: '#7c3aed', /* Violet 600 */
                            bg: '#f5f3ff',
                        }
                    },
                    typography: {
                        DEFAULT: {
                            css: {
                                maxWidth: 'none',
                                h1: { color: '#0f172a', fontWeight: '800' },
                                h2: { color: '#059669', fontWeight: '700', marginTop: '2em', borderBottom: '2px solid #e2e8f0', paddingBottom: '0.5em' },
                                h3: { color: '#334155', fontWeight: '600' },
                                strong: { color: '#059669', fontWeight: '600' },
                                code: { color: '#db2777', backgroundColor: '#f1f5f9', padding: '0.2em 0.4em', borderRadius: '0.25rem' },
                                'code::before': { content: '""' },
                                'code::after': { content: '""' },
                                blockquote: { borderLeftColor: '#059669', fontStyle: 'italic', backgroundColor: '#f0fdf4', padding: '1rem', borderRadius: '0.5rem' },
                            }
                        }
                    }
                }
            }
        }
    </script>

    <!-- 2. Typography Plugin -->
    <script src="https://cdn.tailwindcss.com?plugins=typography"></script>

    <!-- 3. Mermaid.js -->
    <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
    <script>
        mermaid.initialize({
            startOnLoad: true,
            theme: 'base',
            themeVariables: {
                primaryColor: '#d1fae5',
                primaryTextColor: '#064e3b',
                primaryBorderColor: '#059669',
                lineColor: '#64748b',
                secondaryColor: '#fffbeb',
                tertiaryColor: '#f3e8ff',
                fontFamily: 'Inter, sans-serif'
            },
            flowchart: { curve: 'monotoneX' }
        });
    </script>

    <!-- 4. MathJax -->
    <script>
        MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']],
                processEscapes: true
            },
            svg: { fontCache: 'global' }
        };
    </script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

    <!-- 5. Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        body {
            background-color: #f8fafc;
            font-feature-settings: "cv11", "ss01";
        }

        .glass-panel {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(16px);
            border: 1px solid rgba(226, 232, 240, 0.8);
        }

        .gradient-text {
            background: linear-gradient(135deg, #059669 0%, #0891b2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .zoomable {
            cursor: zoom-in;
            transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .zoomable:hover {
            transform: scale(1.02);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }

        .lightbox {
            display: none;
            position: fixed;
            z-index: 10000;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(15, 23, 42, 0.95);
            justify-content: center;
            align-items: center;
            opacity: 0;
            transition: opacity 0.2s;
        }

        .lightbox.active {
            opacity: 1;
        }

        .lightbox img {
            max-width: 95vw;
            max-height: 95vh;
            border-radius: 8px;
            box-shadow: 0 0 50px rgba(0, 0, 0, 0.5);
        }

        /* Code block styling */
        pre {
            background: #1e293b !important;
            color: #e2e8f0 !important;
            border-radius: 0.75rem;
            padding: 1.5rem;
            overflow-x: auto;
            font-family: 'JetBrains Mono', monospace;
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: transparent;
        }

        ::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #94a3b8;
        }

        /* Active TOC */
        .toc-link.active {
            color: #059669;
            border-left: 2px solid #059669;
            background: #ecfdf5;
            font-weight: 600;
        }
    </style>
</head>

<!-- LENGTH-PLAN: total≈15000字 | complexity=medium | structure=system-evolution-analysis -->

<body class="text-slate-700 antialiased selection:bg-emerald-100 selection:text-emerald-900">

    <!-- TOC -->
    <nav id="toc-container"
        class="fixed right-6 top-24 w-64 hidden xl:flex flex-col gap-2 glass-panel rounded-2xl shadow-xl p-5 max-h-[80vh] z-40 transition-all duration-300">
        <div class="flex items-center justify-between mb-4 pb-2 border-b border-slate-100">
            <div id="toc-header"
                class="flex items-center gap-2 text-slate-800 font-bold uppercase text-xs tracking-wider">
                <i class="fas fa-layer-group text-emerald-500"></i> 导航目录
            </div>
            <button id="toc-toggle" class="text-slate-400 hover:text-emerald-600 transition-colors">
                <i class="fas fa-chevron-right" id="toc-icon"></i>
            </button>
        </div>
        <div id="toc-content-wrapper" class="overflow-hidden transition-all duration-300">
            <div id="toc-content"
                class="flex flex-col gap-1 text-sm text-slate-500 overflow-y-auto pr-1 custom-scrollbar"
                style="max-height: 65vh;"></div>
        </div>
    </nav>

    <!-- Main Content -->
    <main
        class="max-w-5xl mx-auto px-6 md:px-12 py-12 my-10 bg-white shadow-2xl rounded-3xl border border-slate-100 relative overflow-hidden">

        <!-- Background Decor -->
        <div
            class="absolute top-0 right-0 -mr-20 -mt-20 w-96 h-96 bg-emerald-50 rounded-full blur-3xl opacity-50 pointer-events-none">
        </div>
        <div
            class="absolute bottom-0 left-0 -ml-20 -mb-20 w-96 h-96 bg-blue-50 rounded-full blur-3xl opacity-50 pointer-events-none">
        </div>

        <!-- Header -->
        <header class="text-center mb-16 relative z-10">
            <div
                class="inline-flex items-center gap-2 bg-emerald-50 text-emerald-700 text-xs font-bold px-4 py-1.5 rounded-full mb-6 border border-emerald-100 shadow-sm">
                <i class="fas fa-file-medical"></i> arXiv:2511.17652v1
            </div>

            <h1 class="text-4xl md:text-6xl font-extrabold tracking-tight mb-6 leading-tight">
                TeamPath: <br class="hidden md:block" />
                <span class="gradient-text">构建基于推理 Copilot 的<br>多模态病理专家系统</span>
            </h1>

            <div class="flex flex-wrap justify-center items-center gap-6 text-sm font-medium text-slate-500 mb-8">
                <span class="flex items-center gap-2"><i class="fas fa-user-friends text-slate-400"></i> Tianyu Liu,
                    Weihao Xuan 等</span>
                <span class="flex items-center gap-2"><i class="fas fa-university text-slate-400"></i> Yale University /
                    RIKEN</span>
                <a href="https://github.com/HelloWorldLTY/TeamPath" target="_blank"
                    class="flex items-center gap-2 text-slate-900 hover:text-emerald-600 transition-colors">
                    <i class="fab fa-github"></i> Code & Models
                </a>
            </div>

            <!-- Core Concept Cards -->
            <div class="grid md:grid-cols-3 gap-4 text-left">
                <div class="glass-panel p-4 rounded-xl shadow-sm border-l-4 border-emerald-500">
                    <div class="text-xs font-bold text-emerald-600 uppercase mb-1">Architecture</div>
                    <div class="font-bold text-slate-800">Router-Based System</div>
                    <div class="text-xs text-slate-500 mt-1">自动路由：在推理、摘要、生成任务间动态切换</div>
                </div>
                <div class="glass-panel p-4 rounded-xl shadow-sm border-l-4 border-indigo-500">
                    <div class="text-xs font-bold text-indigo-600 uppercase mb-1">Core Engine</div>
                    <div class="font-bold text-slate-800">Patho-R1 + RL</div>
                    <div class="text-xs text-slate-500 mt-1">基于 GRPO 的强化学习，具备强逻辑推理能力</div>
                </div>
                <div class="glass-panel p-4 rounded-xl shadow-sm border-l-4 border-amber-500">
                    <div class="text-xs font-bold text-amber-600 uppercase mb-1">Interaction</div>
                    <div class="font-bold text-slate-800">Human-AI Copilot</div>
                    <div class="text-xs text-slate-500 mt-1">自验证/修正循环，修复人类专家或 AI 的错误</div>
                </div>
            </div>
        </header>

        <article class="prose prose-slate prose-lg max-w-none">

            <!-- 0. 作者团队背景 -->
            <section id="sec-authors" class="mb-16">
                <h2 class="flex items-center gap-3 text-2xl font-bold text-slate-900 mb-8">
                    <span class="w-10 h-10 rounded-lg bg-emerald-100 text-emerald-600 flex items-center justify-center text-lg">
                        <i class="fas fa-user-graduate"></i>
                    </span>
                    0. 作者团队背景 (Author Background)
                </h2>

                <div class="bg-slate-50 rounded-3xl p-8 border border-slate-200 shadow-sm">
                    <!-- 0.1 PI Profile -->
                    <div class="grid md:grid-cols-[1.2fr,2fr] gap-8 mb-12 items-start">
                        <div class="space-y-4">
                            <div class="relative group">
                                <div class="absolute -inset-1 bg-gradient-to-r from-blue-600 to-emerald-600 rounded-2xl blur opacity-25 group-hover:opacity-50 transition duration-1000 group-hover:duration-200"></div>
                                <img src="https://ysm-res.cloudinary.com/image/upload/c_limit,f_auto,h_630,q_auto,w_1200/v1/yms/prod/c21896d5-fb8e-41b3-9214-468fd51af7a8" 
                                     alt="Hongyu Zhao Portrait" 
                                     class="relative w-full rounded-2xl shadow-lg object-cover zoomable border-2 border-white"
                                     onclick="openLightbox(this.src)">
                            </div>
                            <div class="text-center">
                                <h3 class="text-xl font-extrabold text-slate-900">Hongyu Zhao, PhD</h3>
                                <p class="text-sm text-blue-600 font-semibold">Ira V. Hiscock Professor</p>
                                <div class="flex justify-center gap-3 mt-3 text-slate-400">
                                    <a href="https://zhaocenter.org" target="_blank" class="hover:text-blue-600"><i class="fas fa-globe"></i></a>
                                    <a href="https://scholar.google.com/citations?user=__z1kpoAAAAJ" target="_blank" class="hover:text-blue-600"><i class="fab fa-google"></i></a>
                                    <a href="https://github.com/hongyuzhao68" target="_blank" class="hover:text-slate-900"><i class="fab fa-github"></i></a>
                                </div>
                            </div>
                        </div>
                        
                        <div class="space-y-6">
                            <div>
                                <h4 class="text-lg font-bold text-slate-800 flex items-center gap-2">
                                    <i class="fas fa-star text-yellow-500"></i> 学术泰斗与跨界枢纽
                                </h4>
                                <p class="text-slate-600 leading-relaxed mt-2 text-sm">
                                    <strong>Hongyu Zhao (赵宏宇)</strong> 教授是统计遗传学与生物信息学领域的国际领军人物。
                                    他于 1990 年获<strong>北京大学</strong>概率统计学士学位，1995 年获<strong>加州大学伯克利分校 (UC Berkeley)</strong> 统计学博士学位。
                                    现任耶鲁大学公共卫生学院生物统计系系主任，同时担任遗传学系和统计与数据科学系教授。
                                </p>
                            </div>

                            <div class="grid grid-cols-2 gap-4">
                                <div class="bg-white p-4 rounded-xl border border-slate-100 shadow-sm">
                                    <div class="text-xs text-slate-400 uppercase font-bold mb-1">Publications</div>
                                    <div class="text-2xl font-bold text-slate-800">750+</div>
                                    <div class="text-xs text-slate-500">Peer-reviewed Papers</div>
                                </div>
                                <div class="bg-white p-4 rounded-xl border border-slate-100 shadow-sm">
                                    <div class="text-xs text-slate-400 uppercase font-bold mb-1">Citations</div>
                                    <div class="text-2xl font-bold text-slate-800">60,000+</div>
                                    <div class="text-xs text-slate-500">Google Scholar</div>
                                </div>
                                <div class="bg-white p-4 rounded-xl border border-slate-100 shadow-sm">
                                    <div class="text-xs text-slate-400 uppercase font-bold mb-1">Mentorship</div>
                                    <div class="text-2xl font-bold text-slate-800">110+</div>
                                    <div class="text-xs text-slate-500">PhD & Postdocs Trained</div>
                                </div>
                                <div class="bg-white p-4 rounded-xl border border-slate-100 shadow-sm">
                                    <div class="text-xs text-slate-400 uppercase font-bold mb-1">Honors</div>
                                    <div class="text-xs font-bold text-slate-800 mt-1">AAAS, ASA, IMS Fellow</div>
                                    <div class="text-xs text-slate-500">Mortimer Spiegelman Award</div>
                                </div>
                            </div>

                            <div>
                                <h4 class="text-sm font-bold text-slate-800 mb-2">学术定位：方法论中枢 (Method Hub)</h4>
                                <p class="text-xs text-slate-600 leading-relaxed">
                                    Zhao Lab 并不局限于单一疾病，而是作为一个<strong>“统计方法—生物医学应用”双轮驱动的中枢</strong>。
                                    一端紧扣概率统计与机器学习前沿（如贝叶斯推断、图模型、深度学习），另一端深度嵌入大规模临床队列（如 UK Biobank, All of Us）。
                                </p>
                            </div>
                        </div>
                    </div>

                    <!-- 0.2 Lab Structure & Group Photo -->
                    <div class="mb-12">
                        <div class="relative rounded-2xl overflow-hidden shadow-lg border border-slate-200 group">
                            <img src="https://zhaocenter.org/assets/img/main-banner/group_figure.jpg" 
                                 alt="Zhao Lab Group Photo" 
                                 class="w-full object-cover transform group-hover:scale-105 transition duration-700 zoomable"
                                 onclick="openLightbox(this.src)">
                            <div class="absolute bottom-0 left-0 right-0 bg-gradient-to-t from-slate-900/90 to-transparent p-6 pt-20">
                                <h4 class="text-white font-bold text-lg">Yale Zhao Lab Team</h4>
                                <p class="text-slate-300 text-xs">一个庞大而活跃的跨学科团队，涵盖统计、计算机、遗传学、生物学等多个背景。</p>
                            </div>
                        </div>
                        
                        <div class="mt-8 grid md:grid-cols-2 gap-6">
                            <div class="bg-white p-5 rounded-xl border-l-4 border-blue-500 shadow-sm">
                                <h5 class="font-bold text-slate-800 mb-2">🔬 四层学术架构</h5>
                                <ul class="text-sm text-slate-600 space-y-2">
                                    <li><strong>方法层 (Method)</strong>: 贝叶斯、网络模型、深度学习、因果推断。</li>
                                    <li><strong>数据层 (Data)</strong>: 多模态 (Omics + Imaging)、多族裔 (Cross-population)、大队列。</li>
                                    <li><strong>疾病层 (Disease)</strong>: 精神疾病 (PTSD)、肿瘤 (Cancer)、心血管 (CVD)。</li>
                                    <li><strong>合作层 (Collaboration)</strong>: 辐射耶鲁医学院及全球顶尖机构的星型合作网络。</li>
                                </ul>
                            </div>
                            <div class="bg-white p-5 rounded-xl border-l-4 border-emerald-500 shadow-sm">
                                <h5 class="font-bold text-slate-800 mb-2">🧬 核心研究方向</h5>
                                <ul class="text-sm text-slate-600 space-y-2">
                                    <li><strong>GWAS & PRS</strong>: 多族裔遗传风险预测 (JointPRS)，解决跨人群泛化难题。</li>
                                    <li><strong>Single Cell & Spatial</strong>: 单细胞多模态对齐 (scMODAL)、空间转录组分析。</li>
                                    <li><strong>AI for Science</strong>: 基因语言模型 (scelmo)、病理大模型 (TeamPath)。</li>
                                    <li><strong>Network Biology</strong>: 基因调控网络推断与药物靶点发现。</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <!-- 0.3 First Authors -->
                    <div>
                        <h4 class="text-lg font-bold text-slate-800 mb-6 flex items-center gap-2">
                            <i class="fas fa-users text-emerald-600"></i> 本文第一作者 (Co-First Authors)
                        </h4>
                        <div class="grid md:grid-cols-2 gap-6">
                            <!-- Tianyu Liu -->
                            <div class="flex gap-4 items-start bg-white p-4 rounded-xl border border-slate-100 shadow-sm">
                                <div class="w-16 h-16 rounded-full overflow-hidden flex-shrink-0 border border-slate-200 shadow-sm bg-slate-50">
                                    <img src="https://avatars.githubusercontent.com/u/43333475?v=4"
                                         alt="Tianyu Liu portrait (GitHub @HelloWorldLTY)"
                                         class="w-full h-full object-cover zoomable"
                                         onclick="openLightbox(this.src)">
                                </div>
                                <div>
                                    <h5 class="font-bold text-slate-800">Tianyu Liu (刘天宇)</h5>
                                    <p class="text-xs text-slate-500 mb-1">Yale University PhD Candidate · HelloWorldLTY</p>
                                    <p class="text-xs text-slate-600 leading-relaxed mb-1">
                                        本科毕业于 UIUC (Highest Honors) 和浙江大学，典型的“计算机 + 统计 + 生物”混合背景。
                                        在 Broad Institute 与 Genentech 的经历，让他非常熟悉从算法原型到真实生产系统的落地路径。
                                    </p>
                                    <p class="text-xs text-slate-600 leading-relaxed">
                                        在 TeamPath 中，他更像是一个“总架构师”角色：既写代码、训模型，也负责把 Patho-R1、Cell2Sentence、Router
                                        等碎片拼接成一个可用的 Copilot 系统——这与很多只做单一 benchmark 的学生非常不同。
                                    </p>
                                </div>
                            </div>

                            <!-- Weihao Xuan -->
                            <div class="flex gap-4 items-start bg-white p-4 rounded-xl border border-slate-100 shadow-sm">
                                <div class="w-16 h-16 rounded-full flex-shrink-0 flex items-center justify-center bg-amber-50 text-amber-600 font-bold text-xl">
                                    X
                                </div>
                                <div>
                                    <h5 class="font-bold text-slate-800">Weihao Xuan (宣伟豪)</h5>
                                    <p class="text-xs text-slate-500 mb-1">UTokyo PhD · RIKEN AIP Junior Research Associate</p>
                                    <p class="text-xs text-slate-600 leading-relaxed mb-1">
                                        东京大学博士生、RIKEN AIP 初级研究员，主要在 <strong>NLP &amp; VLM</strong> 与
                                        <strong>AI for Science</strong> 方向深耕。长期参与大模型 Agent 系统、自动推理与科学工作流自动化。
                                    </p>
                                    <p class="text-xs text-slate-600 leading-relaxed">
                                        在 TeamPath 中，他更偏向于“系统工程师 + 代理系统设计师”：负责多 Agent
                                        协作、Verifier-Corrector 回路以及与通用大模型 (如 o4-mini) 的接口设计。
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 0.4 Zhao Lab 故事线与代表性工作 -->
                    <div class="mt-10 space-y-6">
                        <div class="bg-white p-5 rounded-2xl border border-slate-200 shadow-sm">
                            <h4 class="text-lg font-bold text-slate-800 mb-3 flex items-center gap-2">
                                <i class="fas fa-route text-emerald-600"></i>
                                0.4 从统计课堂到多组学 AI 中枢
                            </h4>
                            <p class="text-sm text-slate-600 leading-relaxed mb-2">
                                如果把 Hongyu Zhao 的职业路径拉成一条时间轴，大致可以分成三个阶段：
                                <strong>统计方法论奠基期</strong>（北大/伯克利）、<strong>遗传学大数据时代</strong>（GWAS &amp; PRS）
                                和<strong>多组学 + AI 集成期</strong>（单细胞、空间组学与基因“语言模型”）。
                            </p>
                            <p class="text-sm text-slate-600 leading-relaxed mb-2">
                                早年，他以传统统计学家身份切入人类遗传学，做的是“如何在高维噪声数据中找出真正的信号”；
                                随着 GWAS 和测序技术成熟，他迅速把这些方法扩展到大队列与多族裔人群，
                                系统地构建了从效应大小分布建模、罕见变异分析到跨人群 PRS 的完整工具链。
                            </p>
                            <p class="text-sm text-slate-600 leading-relaxed">
                                近五到十年，他的重心进一步转向 <strong>单细胞、空间转录组与深度学习</strong>：
                                spVelo、scMODAL、scelmo 等工作可以看作是“基于扎实统计建模的组学 foundation models”。
                                TeamPath 则是在此基础上，与病理学界和 AI 社区深度联动的一个“多模态副驾驶”实践。
                            </p>
                        </div>

                        <div class="bg-white p-5 rounded-2xl border border-slate-200 shadow-sm">
                            <h4 class="text-lg font-bold text-slate-800 mb-3 flex items-center gap-2">
                                <i class="fas fa-book-open text-blue-600"></i>
                                0.5 代表性“大文章”速览
                            </h4>

                            <div class="grid md:grid-cols-2 gap-4 text-sm text-slate-700">
                                <div class="space-y-2">
                                    <h5 class="font-semibold text-emerald-700">遗传风险预测 / GWAS · PRS</h5>
                                    <ul class="list-disc pl-4 space-y-1">
                                        <li><strong>JointPRS</strong> (Nat Commun 2025)：多族裔 PRS 框架，显式建模不同人群间的遗传相关性。</li>
                                        <li><strong>Local ancestry PRS</strong> (AJHG 2025)：在 admixed 人群中利用 local ancestry 提升预测能力。</li>
                                        <li><strong>PRS 调参与偏倚校正</strong> (Nat Commun 2024, Genetics 2025)：只用 summary 统计量完成方法调参与衰减偏倚修正。</li>
                                    </ul>
                                </div>
                                <div class="space-y-2">
                                    <h5 class="font-semibold text-blue-700">单细胞 / 空间组学 · 深度学习</h5>
                                    <ul class="list-disc pl-4 space-y-1">
                                        <li><strong>spVelo</strong> (Genome Biol 2025)：多批次空间转录组数据的 RNA velocity 推断。</li>
                                        <li><strong>scMODAL</strong> (Nat Commun 2025)：通用单细胞多组学对齐框架 + feature links。</li>
                                        <li><strong>scelmo &amp; variant LMs</strong> (bioRxiv 2025)：将 LLM embedding 思路迁移到单细胞与变异数据。</li>
                                    </ul>
                                </div>
                                <div class="space-y-2">
                                    <h5 class="font-semibold text-purple-700">WES/WGS &amp; 罕见变异</h5>
                                    <ul class="list-disc pl-4 space-y-1">
                                        <li><strong>M-DATA</strong> (PLOS Genet 2021)：多性状 de novo 变异联合分析。</li>
                                        <li><strong>Network-assisted CHD</strong> (PLOS Genet 2022)：结合 PPI 网络识别先天性心脏病候选基因。</li>
                                    </ul>
                                </div>
                                <div class="space-y-2">
                                    <h5 class="font-semibold text-rose-700">网络建模 / 脑疾病合作</h5>
                                    <ul class="list-disc pl-4 space-y-1">
                                        <li><strong>Functional graphical models</strong> (JASA 2023)：高维函数图模型与因果网络学习。</li>
                                        <li><strong>PTSD Nature &amp; multi-omics</strong> (Nature 2025, Genome Med 2025)：以单细胞与多组学解析 PTSD 脑机制。</li>
                                    </ul>
                                </div>
                            </div>
                        </div>

                        <div class="bg-emerald-50 p-5 rounded-2xl border border-emerald-200 shadow-sm">
                            <h4 class="text-lg font-bold text-slate-800 mb-3 flex items-center gap-2">
                                <i class="fas fa-lightbulb text-amber-500"></i>
                                0.6 面向我的课题的启发
                            </h4>
                            <ul class="list-disc pl-5 text-sm text-slate-600 space-y-2">
                        
                                <li>
                                    <strong>先有扎实统计建模，再叠加大模型：</strong>
                                    Zhao Lab 的很多工作都扎根于<strong>概率图模型</strong>与<strong>贝叶斯推断</strong>，
                                    并非一上来就盲目追逐大模型或深度学习
                        
                                </li>
                                <li>
                                    <strong>围绕真实临床问题组织多模态数据：</strong>
                                    TeamPath 的设计目标是解决<strong>病理诊断中的复杂推理与生成任务</strong>，
                                    围绕这一核心问题，团队收集并整合了<strong>影像 + 基因组 + 临床文本</strong>等多模态数据。
                        
                                </li>
                                <li>
                                    <strong>跨学科研讨：</strong>
                                    Zhao Lab 很多学生在统计系与医学院之间有双导师或长期合作，这让他们在方法和生物学上都能“听得懂对方的语言”。

                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </section>

            <!-- 1. 演进脉络 -->
            <section id="sec-evolution">
                <h2 class="flex items-center gap-3 text-2xl font-bold text-slate-900">
                    <span
                        class="w-10 h-10 rounded-lg bg-emerald-100 text-emerald-600 flex items-center justify-center text-lg"><i
                            class="fas fa-history"></i></span>
                    1. 从模型到系统：巨人的肩膀
                </h2>

                <p class="text-slate-600 leading-relaxed">
                    TeamPath 并非凭空而生，它是对近期 AI for Science 领域三大里程碑工作（OmiCLIP, Cell2Sentence,
                    Patho-R1）的<strong>系统级集成与升华</strong>。它不再满足于训练单一功能的“模型”（Model），而是构建了一个包含决策、执行、反思的“系统”（System）。
                </p>

                <!-- 演进 Mermaid 图 -->
                <div class="my-8 p-6 bg-slate-50 rounded-2xl border border-slate-200 overflow-x-auto shadow-inner">
                    <h4 class="text-center text-xs font-bold text-slate-400 uppercase tracking-widest mb-4">The
                        Evolution of Pathology AI</h4>
                    <div class="mermaid text-center">
                        graph LR
                        subgraph Foundations["基石技术 (Foundations)"]
                        direction TB
                        C2S["Cell2Sentence\nGene as Text\n生成式组学"]
                        PathoR1["Patho-R1\nReasoning VLM\n病理推理专家"]
                        end

                        subgraph TeamPathSystem["TeamPath System (System 2)"]
                        Router(("LLM Router\n意图识别与分发"))
                        Task1["任务 I: 复杂推理\n(Patho-R1 + GRPO)"]
                        Task2["任务 II: 跨模态生成\n(C2S Logic)"]
                        Task3["任务 III: 助手 Copilot\n(Verifier-Corrector Loop)"]
                        end

                        C2S -.->|提供生成范式| Task2
                        PathoR1 ==> |作为 Base Model| Task1
                        Router --> Task1
                        Router --> Task2
                        Router --> Task3

                        style TeamPathSystem fill:#ecfdf5,stroke:#059669,stroke-width:2px,stroke-dasharray:5 5
                        style C2S fill:#fff,stroke:#eab308
                        style PathoR1 fill:#fff,stroke:#7c3aed
                        style Router fill:#fef3c7,stroke:#d97706,stroke-width:2px
                    </div>
                </div>

                <div class="grid md:grid-cols-2 gap-6 mt-8">
                    <!-- Card 1: Reasoning Model -->
                    <div class="bg-white p-6 rounded-xl border border-slate-200 shadow-sm hover:shadow-md transition-shadow">
                        <h4 class="font-bold text-slate-800 mb-3 flex items-center gap-2 text-lg">
                            <span class="w-8 h-8 rounded-lg bg-purple-100 text-purple-600 flex items-center justify-center">
                                <i class="fas fa-brain"></i>
                            </span>
                            继承自 Patho-R1 (DeepSeek-R1)
                        </h4>
                        <div class="space-y-3 text-sm text-slate-600">
                            <p>
                                Patho-R1 利用deepseek-R1的技术方法实现了病理 AI 从<strong>“简单识别 (Recognition)”</strong>到<strong>“复杂推理 (Reasoning)”</strong>的范式飞跃。它不仅能回答“是什么”，更能通过显式的思维链 (CoT) 解释“为什么”。
                            </p>
                            <div class="bg-purple-50 p-3 rounded-lg border border-purple-100">
                                <h5 class="font-bold text-purple-800 text-xs uppercase mb-2">核心成就：可解释诊断</h5>
                                <div class="rounded-lg overflow-hidden border border-purple-200 mb-2">
                                    <img src="/Users/jay/.gemini/antigravity/brain/6be74915-4f12-4fd2-916b-fa056cb76520/patho_r1_reasoning_cot_1764764237195.png" 
                                         alt="System 1 (Recognition) vs System 2 (Reasoning)" 
                                         class="w-full h-auto zoomable"
                                         onclick="openLightbox(this.src)">
                                </div>
                                <p class="text-xs leading-relaxed text-purple-900">
                                    <strong>从识别到推理</strong>：图示对比了传统 AI 的“黑盒识别”（左）与 Patho-R1 的“透明推理”（右）。通过 GRPO 算法，模型学会了像人类专家一样一步步拆解问题，实现了可信赖的诊断。
                                </p>
                            </div>
                        </div>
                    </div>

                    <!-- Card 2: Cell2Sentence -->
                    <div class="bg-white p-6 rounded-xl border border-slate-200 shadow-sm hover:shadow-md transition-shadow">
                        <h4 class="font-bold text-slate-800 mb-3 flex items-center gap-2 text-lg">
                            <span class="w-8 h-8 rounded-lg bg-amber-100 text-amber-600 flex items-center justify-center">
                                <i class="fas fa-dna"></i>
                            </span>
                            继承自 Cell2Sentence
                        </h4>
                        <div class="space-y-3 text-sm text-slate-600">
                            <p>
                                在“跨模态生成”任务中，TeamPath 采用了 C2S 的核心范式：<strong>将基因表达谱转化为排序的文本序列</strong>。
                            </p>
                            <div class="bg-amber-50 p-3 rounded-lg border border-amber-100">
                                <h5 class="font-bold text-amber-800 text-xs uppercase mb-2">理论基础：Zipf's Law</h5>
                                <div class="rounded-lg overflow-hidden border border-amber-200 mb-2">
                                    <img src="/Users/jay/.gemini/antigravity/brain/6be74915-4f12-4fd2-916b-fa056cb76520/zipfs_law_gene_vs_word_1764764094031.png" 
                                         alt="Zipf's Law: Word Frequency vs Gene Expression" 
                                         class="w-full h-auto zoomable"
                                         onclick="openLightbox(this.src)">
                                </div>
                                <p class="text-xs leading-relaxed text-amber-900">
                                    <strong>齐普夫定律 (Zipf's Law)</strong>：图示展示了自然语言词频（左）与基因表达量（右）惊人的一致性——都服从幂律分布。这证明了用 LLM 处理基因数据的数学合理性。
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- 2. TeamPath 核心架构 -->
            <section id="sec-architecture">
                <h2 class="flex items-center gap-3 text-2xl font-bold text-slate-900 mt-12">
                    <span
                        class="w-10 h-10 rounded-lg bg-emerald-100 text-emerald-600 flex items-center justify-center text-lg"><i
                            class="fas fa-network-wired"></i></span>
                    2. 核心架构：Router 与三大引擎
                </h2>

                <p class="text-slate-600 mb-6">
                    TeamPath 的核心创新在于引入了一个<strong>基于 LLM 的 Router</strong>。面对用户的输入，系统首先判断任务类型，然后调用最佳的“专家模型”或“执行策略”。
                </p>

                <figure class="my-8">
                    <div class="rounded-2xl overflow-hidden shadow-lg border border-slate-200 zoomable bg-white p-2">
                        <img src="https://arxiv.org/html/2511.17652v1/x1.png" alt="TeamPath Overview" class="w-full h-auto object-cover"
                            onclick="openLightbox(this.src)">
                    </div>
                    <figcaption class="text-center text-sm text-slate-500 mt-3">
                        <strong>图 1：TeamPath 系统全景图。</strong> (a-b) 数据集构建；(c) 核心 VLM 架构；(d) <strong>Router
                            机制</strong>：系统根据输入自动路由到推理（VQA）、描述（Caption）或生成（Transcriptomics）模块；(e) 性能雷达图。
                    </figcaption>
                </figure>

                <h3 class="text-xl font-bold text-slate-800 mt-8 mb-4 border-l-4 border-emerald-500 pl-3">2.1 数据构建与预处理 (Data Curation)</h3>
                <p class="text-slate-600 mb-4">
                    TeamPath 的强大性能离不开其精心构建的高质量多模态数据集。为了训练出能够处理复杂病理任务的模型，研究团队设计了一套严谨的数据预处理流程。
                </p>
                
                <p class="text-slate-600 mb-4">
            TeamPath 的核心是一个智能路由系统（Router），它就像一个“分诊台”。
            当用户提出问题时，Router 会首先判断问题的类型：
        </p>
        
        <!-- Router Visualization -->
        <div class="my-6">
            <img src="file:///Users/jay/.gemini/antigravity/brain/6be74915-4f12-4fd2-916b-fa056cb76520/router_mechanism_flow_1764765429583.png" 
                 alt="TeamPath Router Mechanism" 
                 class="rounded-xl shadow-lg w-full zoomable"
                 onclick="openLightbox(this.src)">
            <p class="text-center text-sm text-slate-500 mt-2">图 2.3: TeamPath 的智能路由分诊机制</p>
        </div>

        <ul class="list-disc list-inside text-slate-600 space-y-2 ml-4">
                    <li><strong>Pathology VQA 数据集</strong>：基于 PathMMU 和 PathGen-1.6M，构建了包含 160k+ 高质量问答对的微调数据。</li>
                    <li><strong>Caption 数据集</strong>：从 PubMed Open Access 子集中提取了大量病理图像及其对应的图注，经过清洗后用于训练图像摘要能力。</li>
                    <li><strong>Transcriptomics 数据集</strong>：整合了 HEST-1K 和 STImage1K4M 等公开空间转录组数据，用于训练跨模态生成任务。</li>
                </ul>

                <h4 class="text-lg font-bold text-slate-800 mt-4 mb-3 border-l-4 border-emerald-500 pl-3">2.1.a 数据构建三步走 (Three-Step Pipeline)</h4>
                <p class="text-slate-600 mb-4">
                    高质量的数据是训练多模态大模型的基石。TeamPath 的数据构建流程非常严谨，主要包含以下三个关键步骤：
                </p>
                
                <div class="space-y-6 mb-8">
                    <!-- Step 1: WSI Processing -->
                    <div class="flex gap-4">
                        <div class="flex-shrink-0 w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center text-blue-600 font-bold text-lg">1</div>
                        <div>
                            <h4 class="text-lg font-bold text-slate-800 mb-2">WSI 处理与 Patch 提取</h4>
                            <p class="text-slate-600 text-sm mb-2">
                                原始的 WSI 图像极其巨大，无法直接输入模型。因此，首先需要对其进行预处理：
                            </p>
                            <ul class="list-disc pl-5 text-slate-600 text-sm space-y-1">
                                <li><strong>组织分割 (Tissue Segmentation)</strong>: 使用 Otsu 阈值法或预训练的 UNet 模型去除背景空白区域，仅保留包含组织的区域。</li>
                                <li><strong>切片平铺 (Tiling)</strong>: 将组织区域切割成固定大小的 Patch (例如 256x256 或 512x512 像素)。</li>
                                <li><strong>质量过滤 (Quality Control)</strong>: 剔除模糊、折叠或染色伪影严重的 Patch。</li>
                            </ul>
                        </div>
                    </div>

                    <!-- Step 2: VQA Generation -->
                    <div class="flex gap-4">
                        <div class="flex-shrink-0 w-12 h-12 bg-purple-100 rounded-full flex items-center justify-center text-purple-600 font-bold text-lg">2</div>
                        <div>
                            <h4 class="text-lg font-bold text-slate-800 mb-2">多轮问答数据生成 (VQA Generation)</h4>
                            <p class="text-slate-600 text-sm mb-2">
                                为了让模型学会看图说话，研究团队利用 GPT-4o 强大的多模态能力生成了大量的问答对：
                            </p>
                            <ul class="list-disc pl-5 text-slate-600 text-sm space-y-1">
                                <li><strong>Prompt Engineering</strong>: 设计特定的 Prompt，引导 GPT-4o 关注病理特征（如核异型性、核分裂象）。</li>
                                <li><strong>多轮对话 (Multi-turn Conversation)</strong>: 不仅生成简单的“这是什么”，还生成“为什么是这个诊断”、“有哪些鉴别诊断”等深层次问题。</li>
                                <li><strong>思维链 (Chain-of-Thought)</strong>: 显式要求 GPT-4o 生成推理步骤，作为后续训练 Reasoning Expert 的种子数据。</li>
                            </ul>
                        </div>
                    </div>

                    <!-- Step 3: Filtering -->
                    <div class="flex gap-4">
                        <div class="flex-shrink-0 w-12 h-12 bg-emerald-100 rounded-full flex items-center justify-center text-emerald-600 font-bold text-lg">3</div>
                        <div>
                            <h4 class="text-lg font-bold text-slate-800 mb-2">严格的数据清洗 (Rigorous Filtering)</h4>
                            <p class="text-slate-600 text-sm mb-2">
                                生成的数据难免存在幻觉或错误，因此必须经过严格清洗：
                            </p>
                            <ul class="list-disc pl-5 text-slate-600 text-sm space-y-1">
                                <li><strong>基于规则的过滤</strong>: 去除过短、重复或包含敏感词的回答。</li>
                                <li><strong>一致性校验</strong>: 利用另一个模型（如 Claude 3.5）作为 Verifier，检查问题和答案是否匹配。</li>
                                <li><strong>人工抽检</strong>: 由专业病理医生对随机抽样的数据进行审核，确保医学准确性。</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <figure class="bg-white p-2 rounded-xl shadow border border-slate-100 mb-6">
                    <img src="https://arxiv.org/html/2511.17652v1/x7.png" alt="Data Preprocessing Flowchart" class="w-full h-auto object-contain zoomable"
                        onclick="openLightbox(this.src)">
                    <figcaption class="text-center text-sm text-slate-500 mt-3">
                        <strong>Extended Data Fig. 1: 数据预处理流程图。</strong> 展示了从原始 WSI 到训练数据的完整转换过程：
                        (1) <strong>WSI 处理</strong>: 组织分割与 Patch 提取；
                        (2) <strong>VQA 生成</strong>: 利用 GPT-4o 生成多轮对话数据；
                        (3) <strong>质量控制</strong>: 经过严格的清洗与过滤，确保问答对的准确性。
                    </figcaption>
                </figure>

                <h3 class="text-xl font-bold text-slate-800 mt-8 mb-4 border-l-4 border-emerald-500 pl-3">2.2 任务 I: 推理专家
                    (Reasoning Expert)</h3>
                <p class="text-slate-600 mb-4">
            这是 TeamPath 最具创新性的部分之一。传统的病理 AI 在预测基因表达时，通常将其视为一个
            <strong>回归问题（Regression）</strong>，即直接预测数值。
            但 TeamPath 采用了 <strong>Cell2Sentence</strong> 的思路，将其转化为
            <strong>文本生成问题（Generation）</strong>。
        </p>

        <!-- C2S vs Regression Visualization -->
        <div class="my-6">
            <img src="file:///Users/jay/.gemini/antigravity/brain/6be74915-4f12-4fd2-916b-fa056cb76520/c2s_vs_regression_diagram_1764765464704.png" 
                 alt="Text Generation vs Regression" 
                 class="rounded-xl shadow-lg w-full zoomable"
                 onclick="openLightbox(this.src)">
            <p class="text-center text-sm text-slate-500 mt-2">图 2.4: 文本生成 (Cell2Sentence) vs 传统回归 (Regression) 对比</p>
        </div>

        <div class="bg-amber-50 p-4 rounded-lg border border-amber-100 mb-6">
                    <h4 class="font-bold text-slate-700 mb-3">GRPO 算法详解</h4>
                    <p class="text-slate-600 text-sm mb-2">
                        直观地说，GRPO 的做法是：对同一个问题生成一组回答，看谁比“组平均水平”好，从而决定往哪个方向更新模型，
                        以此避免训练额外的 Critic 模型。
                    </p>
                    <details class="mt-2 group">
                        <summary class="text-xs text-emerald-700 cursor-pointer select-none flex items-center gap-1">
                            <i class="fas fa-chevron-right group-open:rotate-90 transition-transform text-[10px]"></i>
                            展开查看 GRPO 数学形式与奖励细节
                        </summary>
                        <div class="mt-3 border-t border-emerald-100 pt-3">
                            <div class="overflow-x-auto my-2 p-3 bg-white rounded-lg shadow-inner">
                                $$
                                \mathcal{J}_{GRPO}(\theta) = \mathbb{E}_{q \sim P(Q), \{o_i\}_{i=1}^G \sim \pi_{\theta_{old}}(O|q)} \left[ \frac{1}{G} \sum_{i=1}^G \left( \min \left( \frac{\pi_\theta(o_i|q)}{\pi_{\theta_{old}}(o_i|q)} A_i, \text{clip} \left( \frac{\pi_\theta(o_i|q)}{\pi_{\theta_{old}}(o_i|q)}, 1-\epsilon, 1+\epsilon \right) A_i \right) - \beta \mathbb{D}_{KL} (\pi_\theta || \pi_{ref}) \right) \right]
                                $$
                            </div>
                            <p class="text-slate-600 text-xs mb-1">其中：</p>
                            <ul class="list-disc pl-6 text-slate-600 text-xs space-y-1 mb-2">
                                <li>$G$: 每个问题采样的输出组大小 (Group Size)。</li>
                                <li>$A_i$: 优势函数 (Advantage)，$A_i = \dfrac{r_i - \text{mean}(r)}{\text{std}(r)}$，即组内归一化奖励。</li>
                                <li>$\mathbb{D}_{KL}$: KL 散度，用于约束策略更新幅度，防止模型坍塌。</li>
                                <li>$\beta$: KL 惩罚系数。</li>
                            </ul>
                            <p class="text-slate-500 text-xs">
                                对普通读者而言，只要记住：<strong>GRPO 不用额外 Critic，只比较“一群回答里的谁更好”</strong>，
                                这既省算力，又更稳定。
                            </p>
                        </div>
                    </details>
                </div>

                <p class="text-slate-600 mb-4">
                    在 TeamPath 中，奖励函数 $r_i$ 主要由两部分组成：
                </p>
                <ul class="list-disc pl-6 text-slate-600 mb-6">
                    <li><strong>准确性奖励 (Accuracy Reward)</strong>: 答案正确得 1 分，错误得 0 分。</li>
                    <li><strong>格式奖励 (Format Reward)</strong>: 强制模型遵循 <code>&lt;think&gt;...&lt;/think&gt;&lt;answer&gt;...&lt;/answer&gt;</code> 的格式。</li>
                </ul>

                <h3 class="text-xl font-bold text-slate-800 mt-8 mb-4 border-l-4 border-emerald-500 pl-3">2.3 路由系统
                    (Router Module)</h3>
                <p class="text-slate-600 mb-4">
                    为了兼顾性能与效率，TeamPath 引入了一个轻量级的 Router 模块。该模块基于 BERT 架构，负责根据用户问题的复杂度，动态选择最合适的模型进行回答。
                </p>
                <div class="bg-white p-6 rounded-xl border border-slate-200 shadow-sm mb-6">
                    <h4 class="font-bold text-slate-700 mb-3">Router 训练策略</h4>
                    <p class="text-slate-600 text-sm mb-4">
                        Router 的训练目标是最大化系统整体的效率-性能比。具体流程如下：
                    </p>
                    <ol class="list-decimal pl-6 text-slate-600 text-sm space-y-2">
                        <li><strong>数据准备</strong>: 收集大量 PathVQA 问题，并分别使用 Qwen2.5-VL-7B (Base) 和 TeamPath-7B (Expert) 进行回答。</li>
                        <li><strong>标签生成</strong>: 
                            <ul class="list-disc pl-4 mt-1 text-slate-500">
                                <li>如果 Base 模型能答对，标记为 0 (Simple)。</li>
                                <li>如果 Base 模型答错但 Expert 模型能答对，标记为 1 (Hard)。</li>
                                <li>如果都答错，标记为 1 (Hard，倾向于使用更强模型尝试)。</li>
                            </ul>
                        </li>
                        <li><strong>模型训练</strong>: 使用 Cross-Entropy Loss 训练 BERT 分类器。</li>
                        <li><strong>推理阶段</strong>: 对于新问题，Router 输出概率 $p$。若 $p > \tau$ (阈值)，则调用 TeamPath；否则调用 Qwen2.5-VL。</li>
                    </ol>
                </div>    
                <div class="bg-slate-800 rounded-lg p-4 my-4 overflow-x-auto">
                    <details class="group">
                        <summary class="text-xs text-emerald-300 cursor-pointer select-none flex items-center gap-1">
                            <i class="fas fa-chevron-right group-open:rotate-90 transition-transform text-[10px]"></i>
                            查看简化版 GRPO 损失形式
                        </summary>
                        <div class="mt-2 border-t border-slate-700 pt-2">
                            <code class="text-sm text-emerald-300 font-mono block mb-2"># GRPO Loss Function (Simplified)</code>
                            <div class="text-slate-300 font-mono text-xs">
                                $$ J_{GRPO}(\theta) = \mathbb{E} \left[ \frac{1}{G} \sum_{i=1}^{G} \left( \min \left(
                                \frac{\pi_\theta(o|q)}{\pi_{old}(o|q)} \hat{A}_i, \text{clip}(...) \hat{A}_i \right) - \beta
                                D_{KL} \right) \right] $$
                            </div>
                            <p class="text-xs text-slate-400 mt-3">
                                <strong>关键点：</strong> 不使用 Critic 模型，而是通过对同一问题采样一组输出 (Group of outputs)，
                                计算组内相对优势 (Group Relative Advantage) $\hat{A}_i$，在显存有限的情况下也能完成 RL 微调。
                            </p>
                        </div>
                    </details>
                    
                </div>

                <h3 class="text-xl font-bold text-slate-800 mt-8 mb-4 border-l-4 border-amber-500 pl-3">2.4 任务 II: 跨模态生成
                    (Cross-Modality Generation)</h3>
                <p class="text-slate-600 mb-4">
                    这是对 Cell2Sentence (C2S) 的直接应用与扩展。TeamPath 的目标是从 H&E 图像直接预测空间转录组（Spatial Transcriptomics）的基因表达。
                </p>
                <div class="grid md:grid-cols-2 gap-6 bg-amber-50 p-6 rounded-2xl border border-amber-100">
                    <div>
                        <h4 class="font-bold text-amber-800 mb-2">C2S 范式 (Text-based)</h4>
                        <ul class="list-disc pl-5 text-sm text-amber-900 space-y-2">
                            <li><strong>输入</strong>: H&E 图像 Patch。</li>
                            <li><strong>输出</strong>: 一个包含 Top-100 高表达基因名称的<strong>文本序列</strong>。</li>
                            <li><strong>示例</strong>: <code
                                    class="bg-white px-1 rounded text-xs text-pink-600">"MYH7 TNNT2 ACTC1 ..."</code>
                            </li>
                            <li><strong>优势</strong>: 能够利用 LLM 预训练的知识，捕捉基因间的共现关系。</li>
                        </ul>
                    </div>
                    <div>
                        <h4 class="font-bold text-amber-800 mb-2">传统回归 (Regression)</h4>
                        <ul class="list-disc pl-5 text-sm text-amber-900 space-y-2 opacity-60">
                            <li><strong>输入</strong>: H&E 图像 Patch。</li>
                            <li><strong>输出</strong>: 一个 20,000 维的实数向量。</li>
                            <li><strong>劣势</strong>: 难以建模复杂的基因调控网络，容易过拟合。</li>
                        </ul>
                    </div>
                </div>

                <h3 class="text-xl font-bold text-slate-800 mt-8 mb-4 border-l-4 border-blue-500 pl-3">2.5 任务 III:
                    Copilot 协作回路</h3>
                <p class="text-slate-600">
                    这是 TeamPath 区别于纯模型的重要特征。它内置了 <strong>Test-Time Scaling (TTS)</strong> 策略，即在推理阶段通过多次迭代来提升准确率。
                </p>
                <!-- Copilot 算法 Mermaid -->
                <div class="my-6 p-4 bg-white rounded-xl border border-slate-200 shadow-sm">
                    <h4 class="text-center font-bold text-slate-700 mb-4">Algorithm 1: Verifier-Corrector Loop</h4>
                    <div class="mermaid text-center">
                        graph TD
                        %% 使用双引号包裹包含特殊字符的文本
                        Start([用户 / 专家输入答案]) --> Verifier{"Verifier Agent (o4-mini)"}
                        Verifier -->|Answer is Correct| Finish([输出最终结果])
                        Verifier -->|Answer is Wrong| Corrector["Corrector Agent (TeamPath RL)"]
                        Corrector -->|Generate New Answer & Reason| Verifier

                        style Verifier fill:#dbeafe,stroke:#2563eb
                        style Corrector fill:#d1fae5,stroke:#059669
                        style Finish fill:#f3f4f6,stroke:#9ca3af,stroke-dasharray:5 5
                    </div>
                    <p class="text-xs text-slate-500 mt-3 px-4 text-center">
                        系统首先使用一个轻量级或强逻辑模型 (如 o4-mini)
                        作为<strong>Verifier</strong>，检查当前答案（无论是人类专家给出的还是模型生成的）是否合理。如果发现错误，调用 TeamPath
                        的<strong>Corrector</strong> 模块进行重新推理和修正。
                    </p>
                </div>

            </section>

            <!-- 3. 实验结果 -->
            <section id="sec-experiments">
                <h2 class="flex items-center gap-3 text-2xl font-bold text-slate-900 mt-12">
                    <span
                        class="w-10 h-10 rounded-lg bg-emerald-100 text-emerald-600 flex items-center justify-center text-lg"><i
                            class="fas fa-chart-bar"></i></span>
                    3. 实验结果深度分析
                </h2>

                <p class="text-slate-600 mt-4 mb-6">
                    作者用一整套实验，从三个层次检验 TeamPath：
                    <strong>病理问答主战场的硬实力</strong>、
                    <strong>Copilot 带来的系统级收益</strong>，
                    以及在 <strong>图像摘要与空间转录组等跨模态任务</strong> 上是否真的有增益。
                </p>

                <!-- PathVQA 结果 -->
                <div class="mb-10">
                    <h3 class="text-lg font-bold text-slate-800 mb-4">3.1 病理问答 (Pathology VQA) 能力</h3>
                    <p class="text-slate-600 mb-4">
                        在 PathMMU 基准测试中，TeamPath 展现了压倒性优势，超越了通用的 Qwen2.5-VL 和专业的 PathGen-LLaVA。
                    </p>
<div class="bg-indigo-50 p-4 rounded-lg border border-indigo-100 mb-6">
                        <h4 class="font-bold text-indigo-800 text-sm mb-2 flex items-center gap-2">
                            <i class="fas fa-database"></i> 关于 PathMMU 数据集
                        </h4>
                        <p class="text-indigo-900/80 text-sm leading-relaxed">
                            <strong>PathMMU</strong> 是目前病理学领域最具挑战性的大规模多模态评测基准之一。它包含数万个经过专家审核的问答对，
                            覆盖了 H&E、IHC 等多种染色类型及数十种不同的人体组织器官。该数据集专门设计用于测试模型在组织学特征识别、
                            诊断推理及跨模态理解方面的综合能力，是检验“AI 病理学家”真实水平的试金石。
                        </p>
                    </div>


                    <div class="overflow-x-auto mb-6">
                        <table class="min-w-full bg-white border border-slate-200 rounded-lg shadow-sm">
                            <thead class="bg-slate-50">
                                <tr>
                                    <th class="py-3 px-4 text-left text-xs font-bold text-slate-500 uppercase tracking-wider">Model</th>
                                    <th class="py-3 px-4 text-left text-xs font-bold text-slate-500 uppercase tracking-wider">Method</th>
                                    <th class="py-3 px-4 text-left text-xs font-bold text-slate-500 uppercase tracking-wider">Overall Accuracy</th>
                                    <th class="py-3 px-4 text-left text-xs font-bold text-slate-500 uppercase tracking-wider">Router Accuracy</th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-slate-100">
                                <tr>
                                    <td class="py-3 px-4 text-sm text-slate-700 font-medium">Qwen2.5-VL-7B</td>
                                    <td class="py-3 px-4 text-sm text-slate-600">Zero-shot</td>
                                    <td class="py-3 px-4 text-sm text-slate-600">Baseline</td>
                                    <td class="py-3 px-4 text-sm text-slate-600">-</td>
                                </tr>
                                <tr>
                                    <td class="py-3 px-4 text-sm text-slate-700 font-medium">Patho-R1</td>
                                    <td class="py-3 px-4 text-sm text-slate-600">SFT + RL</td>
                                    <td class="py-3 px-4 text-sm text-slate-600">High</td>
                                    <td class="py-3 px-4 text-sm text-slate-600">-</td>
                                </tr>
                                <tr class="bg-emerald-50">
                                    <td class="py-3 px-4 text-sm text-emerald-700 font-bold">TeamPath (Ours)</td>
                                    <td class="py-3 px-4 text-sm text-emerald-600">SFT + GRPO + Router</td>
                                    <td class="py-3 px-4 text-sm text-emerald-600 font-bold">SOTA (p=0.004)</td>
                                    <td class="py-3 px-4 text-sm text-emerald-600">&gt; 80%</td>
                                </tr>
                            </tbody>
                        </table>
                        <p class="text-xs text-slate-400 mt-2 text-center">
                            * p-value = 0.004，表明相对基线模型的提升具有统计学显著性。
                        </p>
                    </div>
                    <figure class="grid md:grid-cols-2 gap-4">
                        <div class="bg-white p-2 rounded-xl shadow border border-slate-100">
                            <img src="https://arxiv.org/html/2511.17652v1/x2.png" alt="VQA Performance" class="w-full h-auto object-contain zoomable"
                                onclick="openLightbox(this.src)">
                        </div>
                        <div class="flex flex-col justify-center">
                            <div class="bg-emerald-50 p-4 rounded-lg mb-4">
                                <span class="text-emerald-800 font-bold block mb-1">Ranking #1</span>
                                <p class="text-sm text-emerald-700">在综合排名图 (Fig 2d) 中，TeamPath
                                    位于左上角（Accuracy最高，Rank最低），气泡颜色最深，表明其在所有子任务上的一致性优越性。</p>
                            </div>
                            <ul class="text-sm text-slate-600 space-y-2 list-disc pl-4">
                                <li><strong>Tiny Set vs Full Set</strong>: 无论是小样本还是全量测试，TeamPath 均保持领先。</li>
                                <li><strong>对比 Patho-R1</strong>: 即使是作为 Base 的 Patho-R1，在经过 TeamPath 的系统级微调（Router +
                                    Specific Data）后，性能也有显著提升。</li>
                            </ul>
                        </div>
                    </figure>
                    <ul class="mt-4 text-sm text-slate-600 space-y-2">
                        <li>在整体准确率和各子任务排名上，TeamPath 明显优于 Qwen2.5-VL 和 PathGen-LLaVA，说明“专门为病理调优的系统”确实比“通用大模型 + 少量病理数据”更靠谱。</li>
                        <li>与 Patho-R1 相比，TeamPath 在同一 base 模型上通过 <strong>Router + Copilot + 更精细的 RL 策略</strong> 继续拔高，这是系统级设计带来的增益。</li>
                        <li>对我课题的意义：在空间任务中，也可以先选一个稳定的 base 模型/分析框架，再通过任务特定的路由和奖励函数做“第二层优化”。</li>
                    </ul>
                </div>

                <!-- Ablation Studies -->
                <div class="mb-10">
                    <h3 class="text-lg font-bold text-slate-800 mb-4">3.2 消融实验与策略优化 (Ablation Studies)</h3>
                    <p class="text-slate-600 mb-4">
                        为了验证 TeamPath 各个组件的有效性，作者进行了详尽的消融实验，重点探究了强化学习策略 (RL Strategy) 和训练数据 (Training Data) 对模型性能的影响。
                    </p>

                    <h4 class="text-md font-bold text-slate-700 mb-3 border-l-4 border-amber-400 pl-3">3.2.1 训练策略优化</h4>
                    <p class="text-slate-600 mb-4">
                        实验对比了不同的 RL 策略（如 PPO, GRPO）以及不同的 Base Model。结果表明，GRPO 在病理问答任务上具有显著优势。
                    </p>
                    <figure class="bg-white p-4 rounded-xl shadow border border-slate-200 mb-6">
                        <img src="https://arxiv.org/html/2511.17652v1/x9.png" alt="Training Strategies Optimization" class="w-full h-auto object-contain zoomable"
                            onclick="openLightbox(this.src)">
                        <figcaption class="text-center text-sm text-slate-500 mt-3">
                            <strong>Extended Data Fig. 3: 训练策略优化对比。</strong> 
                            (a-b) 展示了在 PathMMU 数据集上，不同 RL 策略对准确率 (Accuracy) 和排名 (Rank) 的影响。GRPO 策略在多个子任务上均取得了最佳性能。
                            (c-d) 对比了不同 Base Model (如 Qwen, LLaVA) 在应用 TeamPath 训练策略后的提升幅度。
                        </figcaption>
                    </figure>

                    <h4 class="text-md font-bold text-slate-700 mb-3 border-l-4 border-amber-400 pl-3">3.2.2 数据消融分析</h4>
                    <p class="text-slate-600 mb-4">
                        研究还探讨了引入更多样化的数据（如 Open-ended VQA）是否能进一步提升模型性能。
                        结果有点“反直觉”：在 RL 阶段混入开放式 VQA 数据并没有带来明显收益，
                        只使用高质量、多选题形式的 PathVQA 数据反而是更优解。
                    </p>
                    <p class="text-slate-600 mb-4">
                        这说明在任务高度专业化（如病理鉴别诊断）时，
                        <strong>与下游任务强对齐的一小撮精标数据，比大量但风格不匹配的数据更重要</strong>。
                    </p>
                </div>

                <!-- Case Study: Lipoblast & Synaptophysin -->
                <div class="mb-10">
                    <h3 class="text-lg font-bold text-slate-800 mb-4">3.3 深度案例分析 (Deep Dive Case Studies)</h3>
                    
                    <h4 class="text-md font-bold text-slate-700 mb-3 border-l-4 border-emerald-400 pl-3">案例 A: 脂肪母细胞 (Lipoblast) 识别</h4>
                    <p class="text-slate-600 mb-4">
                        在鉴别脂肪母细胞（Lipoblast）与成熟脂肪细胞时，TeamPath 展现了其对细微形态学特征（如核压迹）的精准捕捉能力。
                    </p>
                    <figure class="bg-white p-2 rounded-xl shadow border border-slate-100 mb-6">
                        <img src="https://arxiv.org/html/2511.17652v1/x3.png" alt="Lipoblast Case Study" class="w-full h-auto object-contain zoomable"
                            onclick="openLightbox(this.src)">
                        <figcaption class="text-center text-sm text-slate-500 mt-2">
                            <strong>图 3：案例研究。</strong> TeamPath 正确识别了脂肪母细胞的特征（核压迹），而其他模型则误判为成熟脂肪细胞（核偏移）。
                        </figcaption>
                    </figure>

                    <h4 class="text-md font-bold text-slate-700 mb-3 border-l-4 border-emerald-400 pl-3">案例 B: 免疫组化染色分析 (Synaptophysin)</h4>
                    <p class="text-slate-600 mb-4">
                        除了 H&E 染色，TeamPath 在处理免疫组化（IHC）图像时也表现出色。以下案例展示了模型对突触素（Synaptophysin）染色的分析。
                    </p>
                    <figure class="bg-white p-4 rounded-xl shadow border border-slate-200 mb-6">
                        <img src="https://arxiv.org/html/2511.17652v1/x8.png" alt="Synaptophysin Case Study" class="w-full h-auto object-contain zoomable"
                            onclick="openLightbox(this.src)">
                        <figcaption class="text-center text-sm text-slate-500 mt-3">
                            <strong>Extended Data Fig. 2: 突触素染色案例分析。</strong> 
                            图中展示了 TeamPath 与其他模型（如 GPT-4o, Claude 3.5）的对比。
                            TeamPath 准确识别了突触素阳性的神经内分泌细胞（Neuroendocrine cells），并正确排除了非特异性背景染色。
                            相比之下，通用多模态模型容易产生幻觉，将背景噪声误判为阳性信号。
                        </figcaption>
                    </figure>
                </div>

                <!-- Copilot 结果 -->
                <div class="mb-10">
                    <h3 class="text-lg font-bold text-slate-800 mb-4">3.4 人机协作 (Copilot) 修正能力</h3>
                    <p class="text-slate-600 mb-4">
                        这是本文最令人兴奋的发现之一。TeamPath 不仅能做题，还能<strong>改错</strong>。通过 Verifier-Corrector 循环，系统能够有效纠正人类专家或自身的错误推理。
                    </p>
                    <figure class="bg-white p-4 rounded-xl shadow border border-slate-100 mb-6">
                        <img src="https://arxiv.org/html/2511.17652v1/x4.png" alt="Copilot Correction" class="w-full h-auto object-contain zoomable"
                            onclick="openLightbox(this.src)">
                        <figcaption class="text-center text-sm text-slate-500 mt-2">
                            <strong>图 4：TeamPath 作为修正者。</strong> (b) 展示了经过 TeamPath 修正后，准确率（Accuracy）显著提升 (p=0.004)。(c)
                            展示了一个具体案例：专家忽略了核仁细节导致误判，TeamPath 指出并修正了推理路径。
                        </figcaption>
                    </figure>

                    <h4 class="text-md font-bold text-slate-700 mb-3 border-l-4 border-blue-400 pl-3">3.4.1 修正人类专家的推理路径</h4>
                    <p class="text-slate-600 mb-4">
                        即使是经验丰富的病理学家，也可能因疲劳或认知偏差犯错，尤其是在长时间阅片时漏掉细小但关键的形态学特征。
                        扩展数据中的案例表明：TeamPath 能在专家已经给出大体正确诊断时，指出其推理链条中的缺口，
                        补充诸如“核仁形态”“背景细胞成分”等被忽略的信息，让报告从“能用”变成“教科书级别”。
                    </p>

                    <h4 class="text-md font-bold text-slate-700 mb-3 border-l-4 border-blue-400 pl-3">3.4.2 Verifier 模型的选择</h4>
                    <p class="text-slate-600 mb-4">
                        Copilot 系统的核心在于 Verifier 的判别能力。作者对比了 GPT-4o、Claude 3.5 Sonnet 以及更轻量的
                        <strong>o4-mini</strong> 作为 Verifier 的表现（Extended Data Fig. 6）。
                        结果显示，小而强的逻辑模型在判断“答案是否自洽、推理是否完整”上反而更稳，兼顾了性能与成本。
                    </p>
                    <p class="text-slate-600 mb-4">
                        启示是：Verifier 不一定要是“最强大模型”，
                        更重要的是 <strong>对当前任务的逻辑敏感度</strong> 和可负担的调用成本。
                        在多模态 pipeline 里，可以考虑用更小的专用模型做 Verifier，把大模型的算力预算留给真正困难的样本。
                    </p>
                </div>

                <!-- Caption Summary 结果 -->
                <div class="mb-10">
                    <h3 class="text-lg font-bold text-slate-800 mb-4">3.5 图像摘要 (Caption Summarization)</h3>
                    <p class="text-slate-600 mb-4">
                        TeamPath 不仅擅长回答问题，还能生成高质量的病理图像摘要，准确描述组织结构和病变特征。
                    </p>
                    <figure class="bg-white p-2 rounded-xl shadow border border-slate-100 mb-6">
                        <img src="https://arxiv.org/html/2511.17652v1/x5.png" alt="Caption Summarization" class="w-full h-auto object-contain zoomable"
                            onclick="openLightbox(this.src)">
                        <figcaption class="text-center text-sm text-slate-500 mt-2">
                            <strong>图 5：图像摘要基准测试。</strong> (a) TeamPath 在 BLEU, ROUGE, BERTScore 等指标上均优于对比模型。(e) 展示了 TeamPath 生成的摘要准确描述了平滑肌细胞的特征。
                        </figcaption>
                    </figure>

                    <h4 class="text-md font-bold text-slate-700 mb-3 border-l-4 border-purple-400 pl-3">3.5.1 摘要生成质量对比</h4>
                    <p class="text-slate-600 mb-4">
                        通过对比不同模型生成的摘要（Extended Data Fig. 7），可以更直观地看到差异：
                        TeamPath 倾向于给出结构化、诊断导向的描述（如明确指出“浸润性导管癌”及其“腺管状结构”），
                        而通用多模态模型的描述往往模糊、模板化，甚至会把癌组织误判为“炎症浸润”等。
                    </p>
                    <p class="text-slate-600 mb-4">
                        对空间转录组和多模态研究来说，这种“自然语言总结病理图像”的能力，
                        为后续把病理描述、基因表达和 GWAS 表型放到同一个语义空间里打下了基础，
                        也为构建 dataset 级的“文字标签 + 组织形态 + omics”对齐提供了思路。
                    </p>
                </div>

                <!-- 跨模态生成结果 -->
                <div class="mb-10">
                    <h3 class="text-lg font-bold text-slate-800 mb-4">3.6 跨模态生成 (Image to Transcriptomics)</h3>
                    <p class="text-slate-600 mb-4">
                        最后一个关键模块是基于 Cell2Sentence 范式的 <strong>Image → Transcriptomics</strong>，
                        也是与我当前研究方向最接近的部分：直接从 H&amp;E 图像预测空间转录组的基因表达谱。
                    </p>
                    <div class="overflow-x-auto">
                        <table class="w-full text-sm text-left text-slate-600">
                            <thead class="text-xs text-slate-700 uppercase bg-slate-50">
                                <tr>
                                    <th class="px-6 py-3">Method</th>
                                    <th class="px-6 py-3">Brain (SPCC) <span class="text-emerald-500">↑</span></th>
                                    <th class="px-6 py-3">Brain (MSE) <span class="text-red-500">↓</span></th>
                                    <th class="px-6 py-3">IDC (SPCC) <span class="text-emerald-500">↑</span></th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr class="bg-white border-b hover:bg-slate-50">
                                    <td class="px-6 py-4 font-medium text-slate-900">Qwen2.5-VL (Base)</td>
                                    <td class="px-6 py-4">0.12</td>
                                    <td class="px-6 py-4">0.85</td>
                                    <td class="px-6 py-4">0.15</td>
                                </tr>
                                <tr class="bg-white border-b hover:bg-slate-50">
                                    <td class="px-6 py-4 font-medium text-slate-900">Cell2Sentence-1B</td>
                                    <td class="px-6 py-4">0.31</td>
                                    <td class="px-6 py-4">0.62</td>
                                    <td class="px-6 py-4">0.28</td>
                                </tr>
                                <tr
                                    class="bg-emerald-50 border-b border-emerald-100 hover:bg-emerald-100 transition-colors">
                                    <td class="px-6 py-4 font-bold text-emerald-700">TeamPath (Ours)</td>
                                    <td class="px-6 py-4 font-bold">0.45</td>
                                    <td class="px-6 py-4 font-bold">0.48</td>
                                    <td class="px-6 py-4 font-bold">0.38</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <p class="text-xs text-slate-400 mt-2">* SPCC: Spot-level Pearson Correlation Coefficient，越高越好。</p>
                    <figure class="bg-white p-2 rounded-xl shadow border border-slate-100 mt-6 mb-6">
                        <img src="https://arxiv.org/html/2511.17652v1/x6.png" alt="Transcriptomics Generation" class="w-full h-auto object-contain zoomable"
                            onclick="openLightbox(this.src)">
                        <figcaption class="text-center text-sm text-slate-500 mt-2">
                            <strong>图 6：转录组生成性能评估。</strong> (a-b) TeamPath 在脑组织和 IDC 数据集上的 SPCC 和 MSE 指标均优于 Baseline。(c-d) UMAP 可视化显示 TeamPath 生成的表达谱与真实数据分布更一致。
                        </figcaption>
                    </figure>

                    <h4 class="text-md font-bold text-slate-700 mb-3 border-l-4 border-pink-400 pl-3">3.6.1 基因表达相关性分析 (GPCC)</h4>
                    <p class="text-slate-600 mb-4">
                        除了 SPCC，作者还分析了基因层面的皮尔逊相关系数 (Gene-level Pearson Correlation Coefficient, GPCC)，
                        用于评估模型对单个基因表达预测的稳定性。
                    </p>
                    <figure class="bg-white p-4 rounded-xl shadow border border-slate-200 mb-6">
                        <img src="https://arxiv.org/html/2511.17652v1/x14.png" alt="GPCC Analysis" class="w-full h-auto object-contain zoomable"
                            onclick="openLightbox(this.src)">
                        <figcaption class="text-center text-sm text-slate-500 mt-3">
                            <strong>Extended Data Fig. 8: 空间转录组生成扩展分析。</strong> 
                            (a-b) 在 Brain 和 IDC 组织中，TeamPath 的 GPCC 分布显著优于对比方法，表明其对不同基因的预测都更加准确；
                            (c-d) 散点图直观展示了 TeamPath 预测值与真实值的相关性，相比微调后的 Qwen2.5-VL，数据点更紧密地分布在对角线附近。
                        </figcaption>
                    </figure>
                    <p class="text-slate-600 mb-4">
                        对我当前做空间多模态的工作来说，这一部分几乎可以直接当成“对标 baseline”：
                        他们证明了 <strong>基因文本化 + VLM</strong> 的路线在真实空间转录组数据上是可行的。
                        下一步可以思考如何把 单核、空间表达和病理图像进一步放到同一套模型或系统里，
                        例如用统一的文本空间同时编码基因列表、病理描述和表型标签。
                    </p>
                </div>
            </section>

            <!-- 4. 总结与讨论 -->
            <section id="sec-discussion">
                <h2 class="flex items-center gap-3 text-2xl font-bold text-slate-900 mt-12">
                    <span
                        class="w-10 h-10 rounded-lg bg-slate-100 text-slate-600 flex items-center justify-center text-lg"><i
                            class="fas fa-comments"></i></span>
                    4. 总结与展望
                </h2>

                <div class="bg-white rounded-2xl p-6 shadow-lg border border-slate-200 mt-6">
                    <p class="text-slate-700 leading-relaxed mb-4">
                        TeamPath 代表了病理 AI 从“单体大模型”向“<strong>多智能体协作系统</strong>”的转变。通过整合 Patho-R1 的推理深度和 Cell2Sentence
                        的生成广度，并辅以 Router 和 Copilot 机制，它构建了一个更加鲁棒、可信的临床助手。
                    </p>

                    <div class="grid md:grid-cols-2 gap-8 mt-6">
                        <div>
                            <h4 class="font-bold text-slate-800 border-b border-slate-100 pb-2 mb-2">核心贡献
                                (Contributions)</h4>
                            <ul class="text-sm text-slate-600 space-y-2">
                                <li class="flex gap-2"><i class="fas fa-check text-emerald-500 mt-1"></i> 提出了 Router
                                    架构，灵活调用 RL 推理或 SFT 生成。</li>
                                <li class="flex gap-2"><i class="fas fa-check text-emerald-500 mt-1"></i> 验证了 GRPO
                                    在多模态病理 VQA 中的有效性。</li>
                                <li class="flex gap-2"><i class="fas fa-check text-emerald-500 mt-1"></i> 建立了
                                    Verifier-Corrector 循环，实现了人机协作纠错。</li>
                            </ul>
                        </div>
                        <div>
                            <h4 class="font-bold text-slate-800 border-b border-slate-100 pb-2 mb-2">局限与未来 (Limitations)
                            </h4>
                            <ul class="text-sm text-slate-600 space-y-2 mb-4">
                                <li class="flex gap-2"><i class="fas fa-exclamation-circle text-amber-500 mt-1"></i> 依赖
                                    Base Model (如 Qwen/Patho-R1) 的能力上限。如果基座模型的视觉编码器无法识别微小的病理特征，强化学习也难以弥补。</li>
                                <li class="flex gap-2"><i class="fas fa-exclamation-circle text-amber-500 mt-1"></i>
                                    隐私保护机制尚待完善。在处理真实患者数据时，需要更严格的去标识化和联邦学习支持。</li>
                                <li class="flex gap-2"><i class="fas fa-arrow-right text-blue-500 mt-1"></i> 未来可探索
                                    Mixture-of-Experts (MoE) 替代简单的 Router，以实现更细粒度的专家分工（如专门的“肿瘤专家”、“炎症专家”）。</li>
                                <li class="flex gap-2"><i class="fas fa-arrow-right text-blue-500 mt-1"></i> 
                                    扩展到更多模态：目前的 TeamPath 主要关注 H&E 染色图像，未来可以扩展到免疫组化 (IHC)、特殊染色甚至基因组数据。</li>
                            </ul>
                            
                            <h5 class="text-xs font-bold text-slate-500 uppercase mb-2">Failure Case Analysis</h5>
                            <figure class="bg-slate-50 p-2 rounded-lg border border-slate-200">
                                <img src="https://arxiv.org/html/2511.17652v1/x15.png" alt="Failure Case" class="w-full h-auto object-contain zoomable"
                                    onclick="openLightbox(this.src)">
                                <figcaption class="text-center text-xs text-slate-400 mt-2">
                                    <strong>Extended Data Fig. 9: 推理与答案不一致案例。</strong> 
                                    虽然 TeamPath 给出了正确的选项（答案正确），但其推理过程却存在逻辑跳跃或错误（推理错误）。
                                    这提示我们，单纯依赖准确率（Accuracy）可能高估了模型的真实理解能力，未来需要更关注推理过程的一致性。
                                </figcaption>
                            </figure>
                        </div>
                    </div>
                </div>
            </section>

            <!-- 5. 复现与参考 -->
            <section id="sec-reproducibility">
                <h2 class="flex items-center gap-3 text-2xl font-bold text-slate-900 mt-12">
                    <span
                        class="w-10 h-10 rounded-lg bg-slate-100 text-slate-600 flex items-center justify-center text-lg"><i
                            class="fas fa-code"></i></span>
                    5. 复现与参考 (Reproducibility)
                </h2>
                <div class="bg-white rounded-2xl p-6 shadow-sm border border-slate-200 mt-6">
                    <ul class="space-y-4">
                        <li class="flex items-start gap-3">
                            <i class="fas fa-file-pdf text-red-500 mt-1"></i>
                            <div>
                                <strong class="text-slate-800">Paper</strong>: 
                                <a href="https://arxiv.org/abs/2511.17652" target="_blank" class="text-emerald-600 hover:underline">TeamPath: Building MultiModal Pathology Experts with Reasoning AI Copilots</a>
                            </div>
                        </li>
                        <li class="flex items-start gap-3">
                            <i class="fab fa-github text-slate-800 mt-1"></i>
                            <div>
                                <strong class="text-slate-800">Code & Models</strong>: 
                                <a href="https://github.com/HelloWorldLTY/TeamPath" target="_blank" class="text-emerald-600 hover:underline">GitHub Repository</a>
                            </div>
                        </li>
                        <li class="flex items-start gap-3">
                            <i class="fas fa-database text-blue-500 mt-1"></i>
                            <div>
                                <strong class="text-slate-800">Datasets</strong>: 
                                PathGen-1.6M, PathMMU, HEST-1K, STImage1K4M
                            </div>
                        </li>
                    </ul>
                </div>
            </section>

        </article>

        <!-- Footer -->
        <footer class="mt-16 pt-8 border-t border-slate-100 text-center text-slate-400 text-sm">
            <p>Analysis based on arXiv:2511.17652v1 | Generated by TeamPath Architecture Expert</p>
        </footer>

        <!-- Technical Appendix -->
        <section id="appendix" class="mb-12">
            <div class="flex items-center gap-3 mb-6">
                <div class="bg-slate-800 text-white w-10 h-10 rounded-full flex items-center justify-center font-bold shadow-lg">
                    <i class="fas fa-code"></i>
                </div>
                <h2 class="text-2xl font-bold text-slate-800">技术附录 (Technical Appendix)</h2>
            </div>

            <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100">
                <h3 class="text-lg font-bold text-slate-800 mb-4">Prompt Templates</h3>
                
                <div class="space-y-6">
                    <!-- PathVQA Prompt -->
                    <div>
                        <h4 class="text-sm font-bold text-slate-600 uppercase mb-2 border-l-4 border-blue-500 pl-2">Pathology VQA Prompt</h4>
                        <div class="bg-slate-50 p-4 rounded-lg border border-slate-200 font-mono text-xs text-slate-700 whitespace-pre-wrap">Your task:
1. Think through the question step by step, enclose your reasoning process in &lt;think&gt;...&lt;/think&gt; tags.
2. Then provide the correct single-letter choice (A, B, C, D,...) inside &lt;answer&gt;...&lt;/answer&gt; tags.
3. No extra information or text outside of these tags.</div>
                    </div>

                    <!-- Verifier Prompt -->
                    <div>
                        <h4 class="text-sm font-bold text-slate-600 uppercase mb-2 border-l-4 border-purple-500 pl-2">Self-Verifier Prompt</h4>
                        <div class="bg-slate-50 p-4 rounded-lg border border-slate-200 font-mono text-xs text-slate-700 whitespace-pre-wrap">You are an expert in pathology. You are given a QUESTION and a PROPOSED SOLUTION. Your job is to:
1. Break down each component of the proposed solution.
2. Think step by step to verify if the proposed solution is correct given the question and the figure.
3. Write a line of the form "The proposed solution is correct" or "The proposed solution is incorrect" at the end of your response.

QUESTION: {question}
PROPOSED SOLUTION: {solution}</div>
                    </div>

                    <!-- Corrector Prompt -->
                    <div>
                        <h4 class="text-sm font-bold text-slate-600 uppercase mb-2 border-l-4 border-emerald-500 pl-2">Reasoning Corrector Prompt</h4>
                        <div class="bg-slate-50 p-4 rounded-lg border border-slate-200 font-mono text-xs text-slate-700 whitespace-pre-wrap">You are given QUESTION, REASON, and SOLUTION. Your task is to correct the REASON and SOLUTION.

QUESTION: {question}
SOLUTION: {solution}
REASON: {reason}

The REASON is WRONG. Your solution:</div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Glossary -->
        <section id="glossary" class="mb-12">
            <div class="flex items-center gap-3 mb-6">
                <div class="bg-slate-800 text-white w-10 h-10 rounded-full flex items-center justify-center font-bold shadow-lg">
                    <i class="fas fa-book"></i>
                </div>
                <h2 class="text-2xl font-bold text-slate-800">术语表 (Glossary)</h2>
            </div>

            <!-- 2.5 数据集构建 -->
    <div class="mb-12">
        <h3 class="text-2xl font-bold text-slate-800 mb-4">2.5 数据集构建：PathMMU</h3>
        <p class="text-slate-600 mb-4">
            为了训练这样一个全能的病理专家，研究团队构建了一个大规模的多模态病理数据集——<strong>PathMMU</strong>。
        </p>
        <div class="grid md:grid-cols-3 gap-4">
            <div class="bg-white p-4 rounded-lg border border-slate-200 text-center">
                <div class="text-3xl font-bold text-blue-600 mb-1">360K+</div>
                <div class="text-sm text-slate-500">指令微调数据 (Instruction Tuning)</div>
            </div>
            <div class="bg-white p-4 rounded-lg border border-slate-200 text-center">
                <div class="text-3xl font-bold text-purple-600 mb-1">16K+</div>
                <div class="text-sm text-slate-500">推理链数据 (CoT Reasoning)</div>
            </div>
            <div class="bg-white p-4 rounded-lg border border-slate-200 text-center">
                <div class="text-3xl font-bold text-emerald-600 mb-1">High-Quality</div>
                <div class="text-sm text-slate-500">教科书级病理图像与描述</div>
            </div>
        </div>
    </div>

    <!-- 2.6 训练基础设施与流程 -->
    <div class="mb-12">
        <h3 class="text-2xl font-bold text-slate-800 mb-4">2.6 训练基础设施与流程 (Training Infrastructure)</h3>
        <p class="text-slate-600 mb-6">
            TeamPath 的训练并非一蹴而就，而是经历了一个严谨的<strong>三阶段流水线 (3-Stage Pipeline)</strong>，
            逐步从通用的病理知识掌握，进阶到复杂的逻辑推理能力。
        </p>

        <!-- Training Pipeline Visualization -->
        <div class="my-8">
            <img src="file:///Users/jay/.gemini/antigravity/brain/6be74915-4f12-4fd2-916b-fa056cb76520/training_pipeline_stages_1764765489512.png" 
                 alt="TeamPath Training Pipeline" 
                 class="rounded-xl shadow-lg w-full zoomable"
                 onclick="openLightbox(this.src)">
            <p class="text-center text-sm text-slate-500 mt-2">图 2.6: TeamPath 的三阶段训练流水线</p>
        </div>

        <div class="space-y-6">
            <div class="flex gap-4">
                <div class="flex-none w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center text-blue-600 font-bold">1</div>
                <div>
                    <h4 class="font-bold text-slate-800">预训练阶段 (Pre-training)</h4>
                    <p class="text-sm text-slate-600 mt-1">
                        <strong>基座模型：</strong> 选用 <code class="bg-slate-100 px-1 rounded">Patho-R1-7B</code> 作为起点。
                        这是一个已经经过大量病理文本和图像预训练的模型，具备了基础的病理学“常识”。
                    </p>
                </div>
            </div>

            <div class="flex gap-4">
                <div class="flex-none w-12 h-12 bg-indigo-100 rounded-full flex items-center justify-center text-indigo-600 font-bold">2</div>
                <div>
                    <h4 class="font-bold text-slate-800">监督微调阶段 (Supervised Fine-Tuning, SFT)</h4>
                    <p class="text-sm text-slate-600 mt-1">
                        <strong>目标：</strong> 学会“听懂指令”。<br>
                        <strong>数据：</strong> 使用 PathMMU 中的 VQA（问答）和 Caption（描述）数据。
                        在这个阶段，模型学会了如何根据医生的指令去观察切片，并用规范的语言回答问题。
                        这对应了 Router 中的 <strong>SFT Expert</strong> 路径。
                    </p>
                </div>
            </div>

            <div class="flex gap-4">
                <div class="flex-none w-12 h-12 bg-purple-100 rounded-full flex items-center justify-center text-purple-600 font-bold">3</div>
                <div>
                    <h4 class="font-bold text-slate-800">强化学习阶段 (Reinforcement Learning, RL)</h4>
                    <p class="text-sm text-slate-600 mt-1">
                        <strong>目标：</strong> 掌握“深度推理”。<br>
                        <strong>核心算法：</strong> <strong>GRPO</strong> (Group Relative Policy Optimization)。<br>
                        <strong>过程：</strong> 针对复杂的鉴别诊断问题，模型会生成多个推理路径。GRPO 算法会根据最终答案的准确性（Accuracy）和推理过程的逻辑性（Format）给予奖励。
                        这让模型学会了像人类专家一样进行“慢思考” (System 2 Thinking)。
                    </p>
                </div>
            </div>
        </div>
    </div> class="bg-white p-4 rounded-lg border border-slate-200 shadow-sm">
                    <h4 class="font-bold text-slate-800">WSI (Whole Slide Image)</h4>
                    <p class="text-sm text-slate-600 mt-1">全玻片图像，指将病理玻璃切片完全扫描成的高分辨率数字图像。</p>
                </div>
                <div class="bg-white p-4 rounded-lg border border-slate-200 shadow-sm">
                    <h4 class="font-bold text-slate-800">IHC (Immunohistochemistry)</h4>
                    <p class="text-sm text-slate-600 mt-1">免疫组化，利用抗原抗体反应检测组织中特定蛋白表达的技术。</p>
                </div>
                <div class="bg-white p-4 rounded-lg border border-slate-200 shadow-sm">
                    <h4 class="font-bold text-slate-800">VQA (Visual Question Answering)</h4>
                    <p class="text-sm text-slate-600 mt-1">视觉问答，一种要求 AI 模型根据图像回答自然语言问题的任务。</p>
                </div>
                <div class="bg-white p-4 rounded-lg border border-slate-200 shadow-sm">
                    <h4 class="font-bold text-slate-800">RL (Reinforcement Learning)</h4>
                    <p class="text-sm text-slate-600 mt-1">强化学习，通过奖励和惩罚机制训练智能体做出最优决策的机器学习方法。</p>
                </div>
                <div class="bg-white p-4 rounded-lg border border-slate-200 shadow-sm">
                    <h4 class="font-bold text-slate-800">GRPO (Group Relative Policy Optimization)</h4>
                    <p class="text-sm text-slate-600 mt-1">组相对策略优化，一种高效的强化学习算法，通过组内优势估计替代 Critic 模型。</p>
                </div>
                <div class="bg-white p-4 rounded-lg border border-slate-200 shadow-sm">
                    <h4 class="font-bold text-slate-800">CoT (Chain-of-Thought)</h4>
                    <p class="text-sm text-slate-600 mt-1">思维链，指模型在给出最终答案前，先生成一系列中间推理步骤的能力。</p>
                </div>
                <div class="bg-white p-4 rounded-lg border border-slate-200 shadow-sm">
                    <h4 class="font-bold text-slate-800">SFT (Supervised Fine-Tuning)</h4>
                    <p class="text-sm text-slate-600 mt-1">监督微调，使用标注好的输入输出对来训练模型，使其适应特定任务。</p>
                </div>
                <div class="bg-white p-4 rounded-lg border border-slate-200 shadow-sm">
                    <h4 class="font-bold text-slate-800">LMM (Large Multimodal Model)</h4>
                    <p class="text-sm text-slate-600 mt-1">多模态大模型，能够同时处理图像、文本等多种模态数据的大型神经网络。</p>
                </div>
            </div>
        </section>

        <!-- Q&A Session -->
        <section id="qa-session" class="mb-12">
            <div class="flex items-center gap-3 mb-6">
                <div class="bg-slate-800 text-white w-10 h-10 rounded-full flex items-center justify-center font-bold shadow-lg">
                    <i class="fas fa-question"></i>
                </div>
                <h2 class="text-2xl font-bold text-slate-800">常见问题解答 (Q&A Session)</h2>
            </div>

            <div class="space-y-6">
                <!-- Q1 -->
                <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-100">
                    <h4 class="text-lg font-bold text-slate-800 mb-2 flex items-start gap-2">
                        <span class="bg-blue-100 text-blue-600 text-xs px-2 py-1 rounded uppercase mt-1">Q1</span>
                        为什么病理学诊断需要多模态大模型 (LMM)？传统的 CNN 不够用吗？
                    </h4>
                    <p class="text-slate-600 text-sm leading-relaxed">
                        传统的深度学习方法（如 ResNet, EfficientNet）在病理图像分类（如癌症/非癌症）上已经取得了很高精度，但它们存在显著局限性：
                        <br><br>
                        1. <strong>缺乏解释性</strong>: CNN 只能给出一个概率值，无法解释“为什么”是癌症，这在临床上是难以接受的。LMM 可以生成自然语言报告，详细描述病变特征，提供诊断依据。<br>
                        2. <strong>交互性差</strong>: 医生无法与 CNN 进行对话，无法追问细节。LMM 支持多轮对话，成为了医生的 AI Copilot。<br>
                        3. <strong>泛化能力弱</strong>: 传统模型通常针对单一任务训练（如肺癌分类），换个器官（如乳腺癌）就需要重新训练。LMM 经过海量数据预训练，具备强大的 Zero-shot 泛化能力。
                    </p>
                </div>

                <!-- Q2 -->
                <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-100">
                    <h4 class="text-lg font-bold text-slate-800 mb-2 flex items-start gap-2">
                        <span class="bg-blue-100 text-blue-600 text-xs px-2 py-1 rounded uppercase mt-1">Q2</span>
                        TeamPath 相比于通用的 GPT-4o 或 Claude 3.5 有什么优势？
                    </h4>
                    <p class="text-slate-600 text-sm leading-relaxed">
                        虽然通用大模型非常强大，但在病理学这一垂直领域仍面临挑战：
                        <br><br>
                        1. <strong>领域知识缺失</strong>: 通用模型训练数据中病理图像占比极低，难以识别细微的病理特征（如核分裂象、印戒细胞）。TeamPath 使用了数百万张专业病理图像进行微调。<br>
                        2. <strong>幻觉问题</strong>: 通用模型倾向于“一本正经地胡说八道”，在医疗领域这是致命的。TeamPath 通过 GRPO 强化学习，显著降低了幻觉率，提高了推理的严谨性。<br>
                        3. <strong>数据隐私</strong>: 使用闭源商业模型（如 GPT-4）需要上传患者数据，存在隐私风险。TeamPath 是开源模型，可以私有化部署在医院内部服务器上。
                    </p>
                </div>

                <!-- Q3 -->
                <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-100">
                    <h4 class="text-lg font-bold text-slate-800 mb-2 flex items-start gap-2">
                        <span class="bg-blue-100 text-blue-600 text-xs px-2 py-1 rounded uppercase mt-1">Q3</span>
                        GRPO 算法相比于 PPO 具体好在哪里？为什么说它更适合大模型训练？
                    </h4>
                    <p class="text-slate-600 text-sm leading-relaxed">
                        PPO (Proximal Policy Optimization) 是强化学习的标杆算法，但在大模型时代显得过于笨重：
                        <br><br>
                        1. <strong>显存占用</strong>: PPO 需要同时加载 Actor (策略模型), Critic (价值模型), Reference Model (参考模型) 和 Reward Model (奖励模型)。对于 7B 参数的模型，这需要巨大的显存。<br>
                        2. <strong>训练稳定性</strong>: Critic 模型的训练本身就很难收敛，容易导致整个 RL 过程崩溃。<br>
                        <br>
                        GRPO (Group Relative Policy Optimization) 巧妙地去掉了 Critic 模型。它通过对同一个问题生成一组（Group）回答，计算这组回答的平均分，然后用每个回答的分数减去平均分作为优势 (Advantage)。这种方法不仅节省了近一半的显存，而且训练更加稳定，非常适合资源受限的学术界和中小企业。
                    </p>
                </div>

                <!-- Q4 -->
                <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-100">
                    <h4 class="text-lg font-bold text-slate-800 mb-2 flex items-start gap-2">
                        <span class="bg-blue-100 text-blue-600 text-xs px-2 py-1 rounded uppercase mt-1">Q4</span>
                        TeamPath 的 Router 机制是如何工作的？会不会导致性能下降？
                    </h4>
                    <p class="text-slate-600 text-sm leading-relaxed">
                        Router 是一个轻量级的 BERT 分类器，它的作用是“分诊”。
                        <br><br>
                        当用户输入一个问题时，Router 首先判断其难度。如果是简单的形态识别问题（如“这是什么组织？”），Router 会将其分发给计算量较小的 Base 模型；如果是复杂的鉴别诊断问题，则分发给经过 RL 强化的 TeamPath Expert 模型。
                        <br><br>
                        实验表明，这种机制不仅没有降低性能，反而提高了整体效率。因为大约 60-70% 的日常问题都很简单，不需要动用昂贵的推理专家。Router 的准确率超过 80%，确保了绝大多数复杂问题都能被正确路由。
                    </p>
                </div>

                <!-- Conclusion -->
        <section class="mb-12">
            <h2 class="text-2xl font-bold text-slate-800 mb-6 flex items-center gap-2">
                <span class="bg-blue-100 text-blue-600 w-8 h-8 rounded-lg flex items-center justify-center text-lg">5</span>
                总结与展望 (Conclusion & Future Work)
            </h2>
            <div class="bg-gradient-to-br from-blue-50 to-indigo-50 p-6 rounded-2xl border border-blue-100">
                <p class="text-slate-700 leading-relaxed mb-4">
                    <strong>TeamPath</strong> 的提出标志着计算病理学从单纯的“感知”（识别癌细胞）迈向了“认知”（理解疾病机理并进行推理）的新阶段。
                </p>
                <p class="text-slate-700 leading-relaxed mb-4">
                    通过引入 <strong>GRPO 强化学习</strong>，TeamPath 成功地将大语言模型的推理能力迁移到了多模态病理领域，不仅在 PathMMU 等基准测试上取得了 SOTA 性能，更重要的是，它具备了自我反思和自我修正的能力，这对于高风险的医疗诊断至关重要。
                </p>
                <p class="text-slate-700 leading-relaxed mb-4">
                    此外，<strong>Router 机制</strong> 的设计巧妙地平衡了性能与效率，使得大规模部署成为可能。而 <strong>AI Copilot</strong> 的理念则强调了人机协作的重要性：AI 不是要取代医生，而是成为医生最得力的助手，帮助医生发现盲点，验证假设，最终提高诊断的准确性和效率。
                </p>
                <p class="text-slate-700 leading-relaxed">
                    展望未来，随着多模态数据的进一步融合（如结合基因组学、影像组学）以及模型推理能力的持续进化，我们有理由相信，TeamPath 及其后续工作将为精准医疗带来革命性的变化，最终造福广大患者。
                </p>
            </div>
        </section>
                <!-- Q5 -->
                <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-100">
                    <h4 class="text-lg font-bold text-slate-800 mb-2 flex items-start gap-2">
                        <span class="bg-blue-100 text-blue-600 text-xs px-2 py-1 rounded uppercase mt-1">Q5</span>
                        未来 TeamPath 还会往哪些方向发展？
                    </h4>
                    <p class="text-slate-600 text-sm leading-relaxed">
                        TeamPath 目前只是一个起点，未来的发展方向非常广阔：
                        <br><br>
                        1. <strong>多模态融合</strong>: 结合基因组学 (Genomics)、转录组学 (Transcriptomics) 和临床电子病历 (EHR) 数据，实现真正的“多模态”诊断.<br>
                        2. <strong>主动学习 (Active Learning)</strong>: 让模型在与医生的交互中不断学习进化，越用越聪明.<br>
                        3. <strong>端侧部署</strong>: 通过模型量化 (Quantization) 和蒸馏 (Distillation)，将 TeamPath 部署到显微镜终端或便携式设备上，辅助基层医疗.
                    </p>
                </div>
            </div>
        </section>

        <!-- Code Implementation Appendix -->
        <section id="code-implementation" class="mb-12">
            <div class="flex items-center gap-3 mb-6">
                <div class="bg-slate-800 text-white w-10 h-10 rounded-full flex items-center justify-center font-bold shadow-lg">
                    <i class="fas fa-laptop-code"></i>
                </div>
                <h2 class="text-2xl font-bold text-slate-800">核心代码实现 (Core Code Implementation)</h2>
            </div>

            <div class="space-y-8">
                <!-- GRPO Loss -->
                <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-100">
                    <h3 class="text-lg font-bold text-slate-800 mb-4 border-l-4 border-blue-500 pl-3">1. GRPO Loss Function (PyTorch)</h3>
                    <p class="text-slate-600 text-sm mb-4">
                        GRPO 的核心在于计算组内相对优势 (Group Relative Advantage)。以下是基于 PyTorch 的简化实现：
                    </p>
                    <div class="bg-slate-900 rounded-lg p-4 overflow-x-auto">
                        <pre class="text-xs font-mono text-blue-300"><code>import torch
import torch.nn.functional as F

def grpo_loss(policy_logprobs, ref_logprobs, rewards, beta=0.1):
    """
    Args:
        policy_logprobs: (batch_size, group_size) - Log probs from current policy
        ref_logprobs: (batch_size, group_size) - Log probs from reference model
        rewards: (batch_size, group_size) - Rewards for each sample in the group
        beta: KL penalty coefficient
    """
    # 1. Compute Group Mean and Std for Advantage
    mean_rewards = rewards.mean(dim=1, keepdim=True)
    std_rewards = rewards.std(dim=1, keepdim=True) + 1e-8
    advantages = (rewards - mean_rewards) / std_rewards

    # 2. Compute KL Divergence (approximate)
    # ratio = (policy_logprobs - ref_logprobs).exp() # PPO style
    # kl_div = policy_logprobs - ref_logprobs # Simple difference for GRPO
    
    # 3. Compute Loss
    # GRPO simplifies PPO by removing the critic and using group stats
    # Loss = - (Advantage * LogProb - beta * KL)
    
    loss = - (advantages * policy_logprobs - beta * (policy_logprobs - ref_logprobs))
    
    return loss.mean()</code></pre>
                    </div>
                </div>

                <!-- Router -->
                <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-100">
                    <h3 class="text-lg font-bold text-slate-800 mb-4 border-l-4 border-purple-500 pl-3">2. Router Module</h3>
                    <p class="text-slate-600 text-sm mb-4">
                        Router 是一个轻量级的分类器，用于判断问题的难度。
                    </p>
                    <div class="bg-slate-900 rounded-lg p-4 overflow-x-auto">
                        <pre class="text-xs font-mono text-purple-300"><code>import torch.nn as nn
from transformers import AutoModel

class ComplexityRouter(nn.Module):
    def __init__(self, model_name='bert-base-uncased', num_classes=2):
        super().__init__()
        self.bert = AutoModel.from_pretrained(model_name)
        self.dropout = nn.Dropout(0.1)
        self.classifier = nn.Linear(768, num_classes) # 0: Simple, 1: Complex

    def forward(self, input_ids, attention_mask):
        outputs = self.bert(input_ids=input_ids, attention_mask=attention_mask)
        pooled_output = outputs.pooler_output
        pooled_output = self.dropout(pooled_output)
        logits = self.classifier(pooled_output)
        return logits

# Usage
router = ComplexityRouter()
difficulty = router(input_ids, attention_mask).argmax(dim=1)
if difficulty == 1:
    model = expert_model # TeamPath
else:
    model = base_model # Qwen-VL</code></pre>
                    </div>
                </div>

                <!-- Dataset -->
                <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-100">
                    <h3 class="text-lg font-bold text-slate-800 mb-4 border-l-4 border-emerald-500 pl-3">3. Pathology VQA Dataset</h3>
                    <p class="text-slate-600 text-sm mb-4">
                        数据加载器需要同时处理图像和文本，并支持多轮对话格式。
                    </p>
                    <div class="bg-slate-900 rounded-lg p-4 overflow-x-auto">
                        <pre class="text-xs font-mono text-emerald-300"><code>from torch.utils.data import Dataset
from PIL import Image

class PathVQADataset(Dataset):
    def __init__(self, data_json, image_dir, transform=None):
        self.data = json.load(open(data_json))
        self.image_dir = image_dir
        self.transform = transform

    def __len__(self):
        return len(self.data)

    def __getitem__(self, idx):
        item = self.data[idx]
        image_path = os.path.join(self.image_dir, item['image'])
        image = Image.open(image_path).convert('RGB')
        
        if self.transform:
            image = self.transform(image)
            
        question = item['question']
        answer = item['answer']
        
        # Format for Qwen-VL
        conversation = [
            {'role': 'user', 'content': f"Picture 1: <img>{image_path}</img>\n{question}"},
            {'role': 'assistant', 'content': answer}
        ]
        
        return {
            'image': image,
            'conversation': conversation
        }</code></pre>
                    </div>
                </div>
            </div>
        </section>

        <!-- Selected References -->
        <section id="references" class="mb-12">
            <div class="flex items-center gap-3 mb-6">
                <div class="bg-slate-800 text-white w-10 h-10 rounded-full flex items-center justify-center font-bold shadow-lg">
                    <i class="fas fa-book-open"></i>
                </div>
                <h2 class="text-2xl font-bold text-slate-800">精选参考文献 (Selected References)</h2>
            </div>

            <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-100">
                <ul class="space-y-4 text-sm text-slate-600">
                    <li class="flex gap-3">
                        <span class="font-bold text-slate-400">[1]</span>
                        <div>
                            <strong>TeamPath: Building MultiModal Pathology Experts with Reasoning AI Copilots.</strong><br>
                            Tianyu Liu, Weihao Xuan, et al. <em>arXiv preprint arXiv:2511.17652</em>, 2025.
                        </div>
                    </li>
                    <li class="flex gap-3">
                        <span class="font-bold text-slate-400">[2]</span>
                        <div>
                            <strong>DeepSeek-R1: Incentivizing Reasoning Capability in LLMs via Reinforcement Learning.</strong><br>
                            DeepSeek-AI. <em>arXiv preprint</em>, 2025.
                        </div>
                    </li>
                    <li class="flex gap-3">
                        <span class="font-bold text-slate-400">[3]</span>
                        <div>
                            <strong>Qwen2.5-VL: A Scalable Vision-Language Model.</strong><br>
                            Alibaba Cloud. <em>arXiv preprint</em>, 2025.
                        </div>
                    </li>
                    <li class="flex gap-3">
                        <span class="font-bold text-slate-400">[4]</span>
                        <div>
                            <strong>Proximal Policy Optimization Algorithms (PPO).</strong><br>
                            Schulman, J., et al. <em>arXiv preprint arXiv:1707.06347</em>, 2017.
                        </div>
                    </li>
                    <li class="flex gap-3">
                        <span class="font-bold text-slate-400">[5]</span>
                        <div>
                            <strong>Visual Instruction Tuning (LLaVA).</strong><br>
                            Liu, H., et al. <em>NeurIPS</em>, 2023.
                        </div>
                    </li>
                    <li class="flex gap-3">
                        <span class="font-bold text-slate-400">[6]</span>
                        <div>
                            <strong>Learning Transferable Visual Models From Natural Language Supervision (CLIP).</strong><br>
                            Radford, A., et al. <em>ICML</em>, 2021.
                        </div>
                    </li>
                    <li class="flex gap-3">
                        <span class="font-bold text-slate-400">[7]</span>
                        <div>
                            <strong>PathMMU: A Massive Multimodal Benchmark for Pathology.</strong><br>
                            Liu, T., et al. <em>arXiv preprint</em>, 2024.
                        </div>
                    </li>
                </ul>
            </div>
        </section>

    </main>

    <!-- Lightbox Container -->
    <div id="lightbox" class="lightbox" onclick="closeLightbox()">
        <img id="lightbox-img" src="" alt="Full View">
        <button
            class="absolute top-4 right-4 text-white text-3xl hover:text-emerald-400 transition-colors">&times;</button>
    </div>

    <script>
        // 1. TOC Generation
        document.addEventListener('DOMContentLoaded', () => {
            const tocContent = document.getElementById('toc-content');
            const headers = document.querySelectorAll('article h2, article h3');

            headers.forEach(header => {
                // Generate ID
                const id = header.innerText.replace(/\s+/g, '-').toLowerCase().replace(/[^\w-]/g, '');
                header.id = id;

                // Create Link
                const link = document.createElement('a');
                link.href = `#${id}`;
                link.className = `toc-link block py-1.5 px-3 rounded-lg hover:bg-slate-50 transition-all ${header.tagName === 'H3' ? 'pl-6 text-xs' : 'font-bold text-slate-700'}`;
                link.innerText = header.innerText.replace(/^[0-9.]+\s*/, ''); // Remove numbering for cleaner TOC

                link.onclick = (e) => {
                    e.preventDefault();
                    document.getElementById(id).scrollIntoView({ behavior: 'smooth' });
                };

                tocContent.appendChild(link);
            });

            // Scroll Spy
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        document.querySelectorAll('.toc-link').forEach(l => l.classList.remove('active'));
                        const activeLink = document.querySelector(`.toc-link[href="#${entry.target.id}"]`);
                        if (activeLink) activeLink.classList.add('active');
                    }
                });
            }, { rootMargin: '-10% 0px -80% 0px' });

            headers.forEach(h => observer.observe(h));
        });

        // 2. TOC Toggle
        const tocContainer = document.getElementById('toc-container');
        const tocToggle = document.getElementById('toc-toggle');
        const tocContentWrapper = document.getElementById('toc-content-wrapper');
        const tocIcon = document.getElementById('toc-icon');
        let isCollapsed = false;

        tocToggle.addEventListener('click', () => {
            isCollapsed = !isCollapsed;
            if (isCollapsed) {
                tocContentWrapper.style.height = '0px';
                tocIcon.style.transform = 'rotate(180deg)';
                tocContainer.classList.add('w-16'); // Shrink width
                tocContainer.classList.remove('w-64');
                document.getElementById('toc-header').style.display = 'none';
            } else {
                tocContentWrapper.style.height = 'auto';
                tocIcon.style.transform = 'rotate(0deg)';
                tocContainer.classList.remove('w-16');
                tocContainer.classList.add('w-64');
                document.getElementById('toc-header').style.display = 'flex';
            }
        });

        // 3. Lightbox Logic
        function openLightbox(src) {
            const lightbox = document.getElementById('lightbox');
            const img = document.getElementById('lightbox-img');
            img.src = src;
            lightbox.style.display = 'flex';
            setTimeout(() => lightbox.classList.add('active'), 10);
        }

        function closeLightbox() {
            const lightbox = document.getElementById('lightbox');
            lightbox.classList.remove('active');
            setTimeout(() => lightbox.style.display = 'none', 200);
        }
    </script>
</body>

</html>
